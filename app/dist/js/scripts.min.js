(function(){var e;e=function(){var e,n,t,a,i,r,o,l,u,c,d,s;t=i(".day"),i=function(e){var n;return n=Array.prototype.slice.apply(document.querySelectorAll(e)),n||(n=[]),n},e=function(){var e,n;n=this,e=function(e,n){e=e||null,n=n||null,this.elem=e,this.value=n,this.hasChanged=!1,this.oninput=function(){}},i(".model").forEach(function(t){t.classList.forEach(function(a){var i,r,o;r=a.match(/model\-/g),r&&(i=a.slice(6),o=t.value,i.indexOf("Month")>-1?o-=1:i.indexOf(!1)&&(o=o||"00:00"),n[i]=n[i]||new e(t,o),t.binding=t.binding||n[i],t.oninput=function(){n[i].hasChanged=!0,n[i]=n[i]||new e(t,o),n[i].value=t.value,n.updateCalculations(),n[i].oninput()})})}),n.updateCalculations=function(){n.startMin=n.startMin||new e(null,n.startTime.value.split(":")[1]),n.startHour=n.startHour||new e(null,n.startTime.value.split(":")[0]),n.endMin=n.endMin||new e(null,n.endTime.value.split(":")[1]),n.endHour=n.endHour||new e(null,n.endTime.value.split(":")[0]),n.date=n.date||new e,n.date.value=new Date(n.startYear.value,n.startMonth.value,n.startDay.value)},n.updateCalculations()},a=function(e,n,t){n.classList.contains("placeholder")&&n.classList.remove("placeholder"),""===e.value&&(e.value=t,e.hasChanged=!1,n.classList.add("placeholder")),n.innerHTML=e.value},c=function(){var e,n,t,a,o;return a=this,e=!1,n="Please correct the following errors: <br>",t=i(".people>div"),o=[{errorMessage:"Please include a title.",validationMethod:function(){return r.title.hasChanged}},{errorMessage:"Please include a description.",validationMethod:function(){return r.description.hasChanged}},{errorMessage:"Please include guests.",validationMethod:function(){return t.length>0?!0:!1}},{errorMessage:"Please include valid email addresses.",validationMethod:function(){var e,n;return e=!1,n=new RegExp("^[-a-z0-9~!$%^&*_=+}{'?]+(.[-a-z0-9~!$%^&*_=+}{'?]+)*@([a-z0-9_][-a-z0-9_]*(.[-a-z0-9_]+)*.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}))(:[0-9]{1,5})?$"),t.forEach(function(t,a){var i;i=n.exec(t.value),e=i&&0===i.index?0===a?!0:e&&!0:e&&!1}),e}}],o.forEach(function(t,i){t.validationMethod(a)?e=0===i?!0:e&&!0:(e=e&&!1,n=n+t.errorMessage+"<br>")}),n=n.trim(),{isValid:e,errorMessage:n}},t.forEach(function(e){var n,t;for(n=1;32>n;)t=document.createElement("option"),10>n?n="0"+n:n+="",t.innerHTML=n,e.appendChild(t),n++}),o=i(".month"),o.forEach(function(e){var n,t;for(n=1;13>n;)t=document.createElement("option"),10>n?n="0"+n:n+="",t.innerHTML=n,e.appendChild(t),n++}),s=i(".year"),s.forEach(function(e){var n,t;for(t=2015;2021>t;)n=document.createElement("option"),n.innerHTML=t+"",e.appendChild(n),t++}),l=document.querySelector("input.new-guest"),u=document.querySelector(".attendees"),l.onkeydown=function(e){var n,t;"Enter"===e.keyIdentifier&&(t=document.createElement("div"),n=document.createElement("button"),n.innerHTML="-",n.parent=t,n.onclick=function(){u.removeChild(this.parent)},t.innerHTML=l.value,t.value=l.value,t.appendChild(n),u.appendChild(t),l.value="")},r=new e,r.title.oninput=function(){var e;e=document.querySelector(".title-display"),a(r.title,e,"Untitled Event")},r.description.oninput=function(){var e;e=document.querySelector(".card-detail-actual.what"),a(r.description,e,"Description")},r.location.oninput=function(){var e;e=document.querySelector(".card-detail-actual.where"),a(r.location,e,"Place")},d=document.querySelector(".card-detail-actual.when"),i(".input-datetime").forEach(function(e){e.binding.oninput=function(){var e;e=r.date.value.toDateString()+" from "+r.startTime.value+" to "+r.endTime.value,a({value:e},d,"Time")}}),n=document.querySelector("button#create"),n.onclick=function(){var e,n;n=c(),n.isValid?alert("Valid form. Thanks for submitting!"):(e=document.querySelector(".error-message"),e.innerHTML=n.errorMessage)}}()}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uY29mZmVlIiwic2NyaXB0cy5taW4uanMiXSwibmFtZXMiOlsiQVBQIiwiTW9kZWwiLCJjcmVhdGVCdXR0b24iLCJkYXlTZWxlY3RvcnMiLCJkaXNwbGF5V2l0aFBsYWNlaG9sZGVyIiwiZ2V0RG9tTm9kZUFycmF5IiwibW9kZWwiLCJtb250aFNlbGVjdG9ycyIsIm5ld0d1ZXN0IiwicGVvcGxlIiwidmFsaWRhdGUiLCJ3aGVuRGlzcGxheSIsInllYXJTZWxlY3RvcnMiLCJzZWxlY3RvciIsIm5vZGVzIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJzbGljZSIsImFwcGx5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiQmluZGluZyIsInNlbGYiLCJ0aGlzIiwiZWxlbSIsInZhbHVlIiwiaGFzQ2hhbmdlZCIsIm9uaW5wdXQiLCJmb3JFYWNoIiwiY2xhc3NMaXN0IiwiY2xhc3NOYW1lIiwibmFtZSIsInBvc3NpYmx5TWF0Y2giLCJtYXRjaCIsImluZGV4T2YiLCJiaW5kaW5nIiwidXBkYXRlQ2FsY3VsYXRpb25zIiwic3RhcnRNaW4iLCJzdGFydFRpbWUiLCJzcGxpdCIsInN0YXJ0SG91ciIsImVuZE1pbiIsImVuZFRpbWUiLCJlbmRIb3VyIiwiZGF0ZSIsIkRhdGUiLCJzdGFydFllYXIiLCJzdGFydE1vbnRoIiwic3RhcnREYXkiLCJpbnB1dEJpbmRpbmciLCJkaXNwbGF5RWxlbSIsInBsYWNlaG9sZGVyIiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGQiLCJpbm5lckhUTUwiLCJhbGxHb29kIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbnMiLCJ2YWxpZGF0aW9uTWV0aG9kIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImxlbmd0aCIsImFyZVJlYWwiLCJlbWFpbFJlZ2V4IiwiUmVnRXhwIiwiZ3Vlc3QiLCJpbmRleCIsInJlc3VsdCIsImV4ZWMiLCJ2YWwiLCJ0cmltIiwiaXNWYWxpZCIsInNlbGVjdEVsZW1lbnQiLCJkYXkiLCJuZXdPcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJtb250aCIsInllYXIiLCJxdWVyeVNlbGVjdG9yIiwib25rZXlkb3duIiwiZXZ0IiwiZGVsZXRlUGVyc29uIiwiZW50ZXJlZFBlcnNvbiIsImtleUlkZW50aWZpZXIiLCJwYXJlbnQiLCJvbmNsaWNrIiwicmVtb3ZlQ2hpbGQiLCJ0aXRsZURpc3BsYXkiLCJkZXNjcmlwdGlvbkRpc3BsYXkiLCJsb2NhdGlvbiIsImxvY2F0aW9uRGlzcGxheSIsInRpbWVUb0Rpc3BsYXkiLCJ0b0RhdGVTdHJpbmciLCJ2YWxpZFN0YXRlIiwiYWxlcnQiLCJjYWxsIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUFBLEdBQUFBLEVBQUFBLEdBQVMsV0FFUCxHQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxDQUlBVCxHQUFlRSxFQUFnQixRQVEvQkEsRUFBa0IsU0FBQ1EsR0FDakIsR0FBQUMsRUNPRSxPRFBGQSxHQUFRQyxNQUFLQyxVQUFFQyxNQUFNQyxNQUFNQyxTQUFTQyxpQkFBaUJQLElBQ2pEQyxJQUNGQSxNQUNGQSxHQU1GYixFQUFRLFdBQ04sR0FBQW9CLEdBQUFDLENBQUFBLEdBQU9DLEtBSVBGLEVBQVUsU0FBQ0csRUFBTUMsR0FDZkQsRUFBT0EsR0FBUSxLQUNmQyxFQUFRQSxHQUFTLEtBQ2pCRixLQUFDQyxLQUFPQSxFQUNSRCxLQUFDRSxNQUFRQSxFQUNURixLQUFDRyxZQUFhLEVBRWRILEtBQUNJLFFBQVUsY0FJYnRCLEVBQWdCLFVBQVV1QixRQUFRLFNBQUNKLEdBQ2pDQSxFQUFLSyxVQUFVRCxRQUFRLFNBQUNFLEdBQ3RCLEdBQUFDLEdBQUFDLEVBQUFQLENBQUFPLEdBQWdCRixFQUFVRyxNQUFNLFlBQzdCRCxJQUVERCxFQUFPRCxFQUFVYixNQUFNLEdBQ3ZCUSxFQUFRRCxFQUFLQyxNQUVWTSxFQUFLRyxRQUFRLFNBQVcsR0FDekJULEdBQWdCLEVBQ1ZNLEVBQUtH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LG1CQUdwRG5GLEVBQU11RCxZQUFZbEMsUUFBVSxXQUMxQixHQUFBK0QsRUFBQUEsR0FBcUJ2RSxTQUFTNkQsY0FBYyw0QkFDNUM1RSxFQUF1QkUsRUFBTXVELFlBQWE2QixFQUFvQixnQkFHaEVwRixFQUFNcUYsU0FBU2hFLFFBQVUsV0FDdkIsR0FBQWlFLEVBQUFBLEdBQWtCekUsU0FBUzZELGNBQWMsNkJBQ3pDNUUsRUFBdUJFLEVBQU1xRixTQUFVQyxFQUFpQixVQUcxRGpGLEVBQWNRLFNBQVM2RCxjQUFjLDRCQUNyQzNFLEVBQWdCLG1CQUFtQnVCLFFBQVEsU0FBQ0osR0FFMUNBLEVBQUtXLFFBQVFSLFFBQVUsV0FFckIsR0FBQWtFLEVBQUFBLEdBQWdCdkYsRUFBTXNDLEtBQUtuQixNQUFNcUUsZUFBaUIsU0FBV3hGLEVBQU1nQyxVQUFVYixNQUFRLE9BQVNuQixFQUFNb0MsUUFBUWpCLE1BQzVHckIsR0FBeUJxQixNQUFPb0UsR0FBaUJsRixFQUFhLFdBSWxFVCxFQUFlaUIsU0FBUzZELGNBQWMsaUJBRXRDOUUsRUFBYXFGLFFBQVUsV0FDckIsR0FBQTlCLEdBQUFzQyxDQUFBQSxHQUFhckYsSUFDVHFGLEVBQVd2QixRQUlid0IsTUFBTSx1Q0FITnZDLEVBQWV0QyxTQUFTNkQsY0FBYyxrQkFDdEN2QixFQUFhRixVQUFZd0MsRUFBV3RDLG9CQ092Q3dDLEtBQUsxRSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIkFQUCA9IGRvIC0+XG5cbiAgIyMjXG4gIEdlbmVyYXRlIGFsbCB0aGUgb3B0aW9ucyBmb3IgdGhlIGRhdGUgZW50cmllc1xuICAjIyNcblxuICBkYXlTZWxlY3RvcnMgPSBnZXREb21Ob2RlQXJyYXkoJy5kYXknKVxuXG4gICMjIypcbiAgIyBDcmVhdGVzIGFuIEFycmF5IG9mIERPTSBub2RlcyB0aGF0IG1hdGNoIHRoZSBzZWxlY3RvclxuICAjIEBwYXJhbSBzZWxlY3RvciB7c3RyaW5nfSBDU1Mgc2VsZWN0b3IgLSBzZWxlY3RvciB0byBtYXRjaCBhZ2FpbnN0XG4gICMgQHJldHVybiB7YXJyYXl9IEFycmF5IG9mIERPTSBub2Rlc1xuICAjIyNcblxuICBnZXREb21Ob2RlQXJyYXkgPSAoc2VsZWN0b3IpIC0+XG4gICAgbm9kZXMgPSBBcnJheTo6c2xpY2UuYXBwbHkoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpXG4gICAgaWYgIW5vZGVzXG4gICAgICBub2RlcyA9IFtdXG4gICAgbm9kZXNcblxuICAjIyNcbiAgY2xhc3M9XCJtb2RlbCBtb2RlbC0qXCIgUmVmZXIgdG8gaW5wdXRzIGJ5IHRoZSBuYW1lIGFmdGVyIGNsYXNzIG1vZGVsLSpcbiAgIyMjXG5cbiAgTW9kZWwgPSAtPlxuICAgIHNlbGYgPSB0aGlzXG4gICAgIyBwdWxscyB2YWx1ZXMgZnJvbSBlbGVtcyBvZiBjbGFzcz1cIm1vZGVsIG1vZGVsLSpcIlxuICAgICMgdG8gY3JlYXRlIE1vZGVsJ3MgcmF3IGluZm8gYW5kIHNldCB1cCAxLXdheSBiaW5kaW5nXG5cbiAgICBCaW5kaW5nID0gKGVsZW0sIHZhbHVlKSAtPlxuICAgICAgZWxlbSA9IGVsZW0gb3IgbnVsbFxuICAgICAgdmFsdWUgPSB2YWx1ZSBvciBudWxsXG4gICAgICBAZWxlbSA9IGVsZW1cbiAgICAgIEB2YWx1ZSA9IHZhbHVlXG4gICAgICBAaGFzQ2hhbmdlZCA9IGZhbHNlXG5cbiAgICAgIEBvbmlucHV0ID0gLT5cblxuICAgICAgcmV0dXJuXG5cbiAgICBnZXREb21Ob2RlQXJyYXkoJy5tb2RlbCcpLmZvckVhY2ggKGVsZW0pIC0+XG4gICAgICBlbGVtLmNsYXNzTGlzdC5mb3JFYWNoIChjbGFzc05hbWUpIC0+XG4gICAgICAgIHBvc3NpYmx5TWF0Y2ggPSBjbGFzc05hbWUubWF0Y2goL21vZGVsXFwtL2cpXG4gICAgICAgIGlmIHBvc3NpYmx5TWF0Y2hcbiAgICAgICAgICAjIGNyZWF0ZSB0aGUgTW9kZWwgdmFsdWVcbiAgICAgICAgICBuYW1lID0gY2xhc3NOYW1lLnNsaWNlKDYpXG4gICAgICAgICAgdmFsdWUgPSBlbGVtLnZhbHVlXG4gICAgICAgICAgIyBzZXQgZGVmYXVsdCB2YWx1ZXNcbiAgICAgICAgICBpZiBuYW1lLmluZGV4T2YoJ01vbnRoJykgPiAtMVxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSAtIDFcbiAgICAgICAgICBlbHNlIGlmIG5hbWUuaW5kZXhPZignVGltZScgPiAtMSlcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgb3IgJzAwOjAwJ1xuICAgICAgICAgIHNlbGZbbmFtZV0gPSBzZWxmW25hbWVdIG9yIG5ldyBCaW5kaW5nKGVsZW0sIHZhbHVlKVxuICAgICAgICAgIGVsZW0uYmluZGluZyA9IGVsZW0uYmluZGluZyBvciBzZWxmW25hbWVdXG4gICAgICAgICAgIyBiaW5kIGRhdGEgb25pbnB1dFxuXG4gICAgICAgICAgZWxlbS5vbmlucHV0ID0gLT5cbiAgICAgICAgICAgIHNlbGZbbmFtZV0uaGFzQ2hhbmdlZCA9IHRydWVcbiAgICAgICAgICAgIHNlbGZbbmFtZV0gPSBzZWxmW25hbWVdIG9yIG5ldyBCaW5kaW5nKGVsZW0sIHZhbHVlKVxuICAgICAgICAgICAgc2VsZltuYW1lXS52YWx1ZSA9IGVsZW0udmFsdWVcbiAgICAgICAgICAgIHNlbGYudXBkYXRlQ2FsY3VsYXRpb25zKClcbiAgICAgICAgICAgICMgZm9yIGNhbGxiYWNrc1xuICAgICAgICAgICAgc2VsZltuYW1lXS5vbmlucHV0KClcbiAgICAgICAgICAgIHJldHVyblxuXG4gICAgICAgIHJldHVyblxuICAgICAgcmV0dXJuXG5cbiAgICBzZWxmLnVwZGF0ZUNhbGN1bGF0aW9ucyA9IC0+XG4gICAgICBzZWxmLnN0YXJ0TWluID0gc2VsZi5zdGFydE1pbiBvciBuZXcgQmluZGluZyhudWxsLCBzZWxmLnN0YXJ0VGltZS52YWx1ZS5zcGxpdCgnOicpWzFdKVxuICAgICAgc2VsZi5zdGFydEhvdXIgPSBzZWxmLnN0YXJ0SG91ciBvciBuZXcgQmluZGluZyhudWxsLCBzZWxmLnN0YXJ0VGltZS52YWx1ZS5zcGxpdCgnOicpWzBdKVxuICAgICAgc2VsZi5lbmRNaW4gPSBzZWxmLmVuZE1pbiBvciBuZXcgQmluZGluZyhudWxsLCBzZWxmLmVuZFRpbWUudmFsdWUuc3BsaXQoJzonKVsxXSlcbiAgICAgIHNlbGYuZW5kSG91ciA9IHNlbGYuZW5kSG91ciBvciBuZXcgQmluZGluZyhudWxsLCBzZWxmLmVuZFRpbWUudmFsdWUuc3BsaXQoJzonKVswXSlcbiAgICAgIHNlbGYuZGF0ZSA9IHNlbGYuZGF0ZSBvciBuZXcgQmluZGluZ1xuICAgICAgc2VsZi5kYXRlLnZhbHVlID0gbmV3IERhdGUoc2VsZi5zdGFydFllYXIudmFsdWUsIHNlbGYuc3RhcnRNb250aC52YWx1ZSwgc2VsZi5zdGFydERheS52YWx1ZSlcbiAgICAgIHJldHVyblxuXG4gICAgc2VsZi51cGRhdGVDYWxjdWxhdGlvbnMoKVxuICAgIHJldHVyblxuXG4gICMjI1xuICBUbyBjcmVhdGUgYSBwbGFjZWhvbGRlciBlZmZlY3QuIEFzc3VtZXMgdGhhdCBkaXNwbGF5IGVsZW1lbnQgc3RhcnRzIHdpdGggJ3BsYWNlaG9sZGVyJyBjbGFzc1xuICAjIyNcblxuICBkaXNwbGF5V2l0aFBsYWNlaG9sZGVyID0gKGlucHV0QmluZGluZywgZGlzcGxheUVsZW0sIHBsYWNlaG9sZGVyKSAtPlxuICAgIGlmIGRpc3BsYXlFbGVtLmNsYXNzTGlzdC5jb250YWlucygncGxhY2Vob2xkZXInKVxuICAgICAgZGlzcGxheUVsZW0uY2xhc3NMaXN0LnJlbW92ZSAncGxhY2Vob2xkZXInXG4gICAgaWYgaW5wdXRCaW5kaW5nLnZhbHVlID09ICcnXG4gICAgICBpbnB1dEJpbmRpbmcudmFsdWUgPSBwbGFjZWhvbGRlclxuICAgICAgIyBsZXQgdGhlIG1vZGVsIGtub3cgdGhhdCBpbnB1dCBoYXMgZ29uZSBiYWNrIHRvIGRlZmF1bHRcbiAgICAgIGlucHV0QmluZGluZy5oYXNDaGFuZ2VkID0gZmFsc2VcbiAgICAgIGRpc3BsYXlFbGVtLmNsYXNzTGlzdC5hZGQgJ3BsYWNlaG9sZGVyJ1xuICAgIGRpc3BsYXlFbGVtLmlubmVySFRNTCA9IGlucHV0QmluZGluZy52YWx1ZVxuICAgIHJldHVyblxuXG4gIHZhbGlkYXRlID0gLT5cbiAgICBzZWxmID0gdGhpc1xuICAgIGFsbEdvb2QgPSBmYWxzZVxuICAgIGVycm9yTWVzc2FnZSA9ICdQbGVhc2UgY29ycmVjdCB0aGUgZm9sbG93aW5nIGVycm9yczogPGJyPidcbiAgICBwZW9wbGUgPSBnZXREb21Ob2RlQXJyYXkoJy5wZW9wbGU+ZGl2JylcbiAgICB2YWxpZGF0aW9ucyA9IFtcbiAgICAgIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlOiAnUGxlYXNlIGluY2x1ZGUgYSB0aXRsZS4nXG4gICAgICAgIHZhbGlkYXRpb25NZXRob2Q6IC0+XG4gICAgICAgICAgbW9kZWwudGl0bGUuaGFzQ2hhbmdlZFxuXG4gICAgICB9XG4gICAgICB7XG4gICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIGEgZGVzY3JpcHRpb24uJ1xuICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiAtPlxuICAgICAgICAgIG1vZGVsLmRlc2NyaXB0aW9uLmhhc0NoYW5nZWRcblxuICAgICAgfVxuICAgICAge1xuICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSBndWVzdHMuJ1xuICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiAtPlxuICAgICAgICAgIGlmIHBlb3BsZS5sZW5ndGggPiAwXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgZmFsc2VcblxuICAgICAgfVxuICAgICAge1xuICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSB2YWxpZCBlbWFpbCBhZGRyZXNzZXMuJ1xuICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiAtPlxuICAgICAgICAgIGFyZVJlYWwgPSBmYWxzZVxuICAgICAgICAgIGVtYWlsUmVnZXggPSBuZXcgUmVnRXhwKCdeWy1hLXowLTl+ISQlXiYqXz0rfXtcXCc/XSsoLlstYS16MC05fiEkJV4mKl89K317XFwnP10rKSpAKFthLXowLTlfXVstYS16MC05X10qKC5bLWEtejAtOV9dKykqLihhZXJvfGFycGF8Yml6fGNvbXxjb29wfGVkdXxnb3Z8aW5mb3xpbnR8bWlsfG11c2V1bXxuYW1lfG5ldHxvcmd8cHJvfHRyYXZlbHxtb2JpfFthLXpdW2Etel0pfChbMC05XXsxLDN9LlswLTldezEsM30uWzAtOV17MSwzfS5bMC05XXsxLDN9KSkoOlswLTldezEsNX0pPyQnKVxuICAgICAgICAgIHBlb3BsZS5mb3JFYWNoIChndWVzdCwgaW5kZXgpIC0+XG4gICAgICAgICAgICByZXN1bHQgPSBlbWFpbFJlZ2V4LmV4ZWMoZ3Vlc3QudmFsdWUpXG4gICAgICAgICAgICBpZiByZXN1bHQgYW5kIHJlc3VsdFsnaW5kZXgnXSA9PSAwXG4gICAgICAgICAgICAgIGlmIGluZGV4ID09IDBcbiAgICAgICAgICAgICAgICBhcmVSZWFsID0gdHJ1ZVxuICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgYXJlUmVhbCA9IGFyZVJlYWwgYW5kIHRydWVcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgYXJlUmVhbCA9IGFyZVJlYWwgYW5kIGZhbHNlXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICBhcmVSZWFsXG5cbiAgICAgIH1cbiAgICBdXG4gICAgdmFsaWRhdGlvbnMuZm9yRWFjaCAodmFsLCBpbmRleCkgLT5cbiAgICAgIGlmIHZhbC52YWxpZGF0aW9uTWV0aG9kKHNlbGYpXG4gICAgICAgIGlmIGluZGV4ID09IDBcbiAgICAgICAgICBhbGxHb29kID0gdHJ1ZVxuICAgICAgICBlbHNlXG4gICAgICAgICAgYWxsR29vZCA9IGFsbEdvb2QgYW5kIHRydWVcbiAgICAgIGVsc2VcbiAgICAgICAgYWxsR29vZCA9IGFsbEdvb2QgYW5kIGZhbHNlXG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSArIHZhbC5lcnJvck1lc3NhZ2UgKyAnPGJyPidcbiAgICAgIHJldHVyblxuICAgIGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZS50cmltKClcbiAgICB7XG4gICAgICBpc1ZhbGlkOiBhbGxHb29kXG4gICAgICBlcnJvck1lc3NhZ2U6IGVycm9yTWVzc2FnZVxuICAgIH1cblxuICBkYXlTZWxlY3RvcnMuZm9yRWFjaCAoc2VsZWN0RWxlbWVudCkgLT5cbiAgICBkYXkgPSAxXG4gICAgd2hpbGUgZGF5IDwgMzJcbiAgICAgIG5ld09wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXG4gICAgICBpZiBkYXkgPCAxMFxuICAgICAgICBkYXkgPSAnMCcgKyBkYXlcbiAgICAgIGVsc2VcbiAgICAgICAgZGF5ID0gZGF5ICsgJydcbiAgICAgIG5ld09wdGlvbi5pbm5lckhUTUwgPSBkYXlcbiAgICAgIHNlbGVjdEVsZW1lbnQuYXBwZW5kQ2hpbGQgbmV3T3B0aW9uXG4gICAgICBkYXkrK1xuICAgIHJldHVyblxuICBtb250aFNlbGVjdG9ycyA9IGdldERvbU5vZGVBcnJheSgnLm1vbnRoJylcbiAgbW9udGhTZWxlY3RvcnMuZm9yRWFjaCAoc2VsZWN0RWxlbWVudCkgLT5cbiAgICBtb250aCA9IDFcbiAgICB3aGlsZSBtb250aCA8IDEzXG4gICAgICBuZXdPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxuICAgICAgaWYgbW9udGggPCAxMFxuICAgICAgICBtb250aCA9ICcwJyArIG1vbnRoXG4gICAgICBlbHNlXG4gICAgICAgIG1vbnRoID0gbW9udGggKyAnJ1xuICAgICAgbmV3T3B0aW9uLmlubmVySFRNTCA9IG1vbnRoXG4gICAgICBzZWxlY3RFbGVtZW50LmFwcGVuZENoaWxkIG5ld09wdGlvblxuICAgICAgbW9udGgrK1xuICAgIHJldHVyblxuICB5ZWFyU2VsZWN0b3JzID0gZ2V0RG9tTm9kZUFycmF5KCcueWVhcicpXG4gIHllYXJTZWxlY3RvcnMuZm9yRWFjaCAoc2VsZWN0RWxlbWVudCkgLT5cbiAgICB5ZWFyID0gMjAxNVxuICAgIHdoaWxlIHllYXIgPCAyMDIxXG4gICAgICBuZXdPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxuICAgICAgbmV3T3B0aW9uLmlubmVySFRNTCA9IHllYXIgKyAnJ1xuICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmRDaGlsZCBuZXdPcHRpb25cbiAgICAgIHllYXIrK1xuICAgIHJldHVyblxuXG4gICMjI1xuICBBZGRpbmcgZ3Vlc3RzXG4gICMjI1xuXG4gIG5ld0d1ZXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXQubmV3LWd1ZXN0JylcbiAgcGVvcGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF0dGVuZGVlcycpXG5cbiAgbmV3R3Vlc3Qub25rZXlkb3duID0gKGV2dCkgLT5cbiAgICBpZiBldnQua2V5SWRlbnRpZmllciA9PSAnRW50ZXInXG4gICAgICBlbnRlcmVkUGVyc29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgIGRlbGV0ZVBlcnNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgICBkZWxldGVQZXJzb24uaW5uZXJIVE1MID0gJy0nXG4gICAgICBkZWxldGVQZXJzb24ucGFyZW50ID0gZW50ZXJlZFBlcnNvblxuXG4gICAgICBkZWxldGVQZXJzb24ub25jbGljayA9IC0+XG4gICAgICAgIHBlb3BsZS5yZW1vdmVDaGlsZCBAcGFyZW50XG4gICAgICAgIHJldHVyblxuXG4gICAgICBlbnRlcmVkUGVyc29uLmlubmVySFRNTCA9IG5ld0d1ZXN0LnZhbHVlXG4gICAgICBlbnRlcmVkUGVyc29uLnZhbHVlID0gbmV3R3Vlc3QudmFsdWVcbiAgICAgICMgZm9yIGVhc3kgYWNjZXNzIGxhdGVyXG4gICAgICBlbnRlcmVkUGVyc29uLmFwcGVuZENoaWxkIGRlbGV0ZVBlcnNvblxuICAgICAgcGVvcGxlLmFwcGVuZENoaWxkIGVudGVyZWRQZXJzb25cbiAgICAgIG5ld0d1ZXN0LnZhbHVlID0gJydcbiAgICByZXR1cm5cblxuICBtb2RlbCA9IG5ldyBNb2RlbFxuICAjIFVwZGF0ZSB0aGUgdmlldyBvbmlucHV0XG5cbiAgbW9kZWwudGl0bGUub25pbnB1dCA9IC0+XG4gICAgdGl0bGVEaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRpdGxlLWRpc3BsYXknKVxuICAgIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIgbW9kZWwudGl0bGUsIHRpdGxlRGlzcGxheSwgJ1VudGl0bGVkIEV2ZW50J1xuICAgIHJldHVyblxuXG4gIG1vZGVsLmRlc2NyaXB0aW9uLm9uaW5wdXQgPSAtPlxuICAgIGRlc2NyaXB0aW9uRGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLWRldGFpbC1hY3R1YWwud2hhdCcpXG4gICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlciBtb2RlbC5kZXNjcmlwdGlvbiwgZGVzY3JpcHRpb25EaXNwbGF5LCAnRGVzY3JpcHRpb24nXG4gICAgcmV0dXJuXG5cbiAgbW9kZWwubG9jYXRpb24ub25pbnB1dCA9IC0+XG4gICAgbG9jYXRpb25EaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtZGV0YWlsLWFjdHVhbC53aGVyZScpXG4gICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlciBtb2RlbC5sb2NhdGlvbiwgbG9jYXRpb25EaXNwbGF5LCAnUGxhY2UnXG4gICAgcmV0dXJuXG5cbiAgd2hlbkRpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZC1kZXRhaWwtYWN0dWFsLndoZW4nKVxuICBnZXREb21Ob2RlQXJyYXkoJy5pbnB1dC1kYXRldGltZScpLmZvckVhY2ggKGVsZW0pIC0+XG5cbiAgICBlbGVtLmJpbmRpbmcub25pbnB1dCA9IC0+XG4gICAgICAjIFRPRE86IGEgYml0IGhhY2t5XG4gICAgICB0aW1lVG9EaXNwbGF5ID0gbW9kZWwuZGF0ZS52YWx1ZS50b0RhdGVTdHJpbmcoKSArICcgZnJvbSAnICsgbW9kZWwuc3RhcnRUaW1lLnZhbHVlICsgJyB0byAnICsgbW9kZWwuZW5kVGltZS52YWx1ZVxuICAgICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlciB7IHZhbHVlOiB0aW1lVG9EaXNwbGF5IH0sIHdoZW5EaXNwbGF5LCAnVGltZSdcbiAgICAgIHJldHVyblxuXG4gICAgcmV0dXJuXG4gIGNyZWF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbiNjcmVhdGUnKVxuXG4gIGNyZWF0ZUJ1dHRvbi5vbmNsaWNrID0gLT5cbiAgICB2YWxpZFN0YXRlID0gdmFsaWRhdGUoKVxuICAgIGlmICF2YWxpZFN0YXRlLmlzVmFsaWRcbiAgICAgIGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcnJvci1tZXNzYWdlJylcbiAgICAgIGVycm9yTWVzc2FnZS5pbm5lckhUTUwgPSB2YWxpZFN0YXRlLmVycm9yTWVzc2FnZVxuICAgIGVsc2VcbiAgICAgIGFsZXJ0ICdWYWxpZCBmb3JtLiBUaGFua3MgZm9yIHN1Ym1pdHRpbmchJ1xuICAgIHJldHVyblxuXG4gIHJldHVybiIsIihmdW5jdGlvbigpIHtcbiAgdmFyIEFQUDtcblxuICBBUFAgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICAvKlxuICAgIEdlbmVyYXRlIGFsbCB0aGUgb3B0aW9ucyBmb3IgdGhlIGRhdGUgZW50cmllc1xuICAgICAqL1xuICAgIHZhciBNb2RlbCwgY3JlYXRlQnV0dG9uLCBkYXlTZWxlY3RvcnMsIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIsIGdldERvbU5vZGVBcnJheSwgbW9kZWwsIG1vbnRoU2VsZWN0b3JzLCBuZXdHdWVzdCwgcGVvcGxlLCB2YWxpZGF0ZSwgd2hlbkRpc3BsYXksIHllYXJTZWxlY3RvcnM7XG4gICAgZGF5U2VsZWN0b3JzID0gZ2V0RG9tTm9kZUFycmF5KCcuZGF5Jyk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEFycmF5IG9mIERPTSBub2RlcyB0aGF0IG1hdGNoIHRoZSBzZWxlY3RvclxuICAgICAqIEBwYXJhbSBzZWxlY3RvciB7c3RyaW5nfSBDU1Mgc2VsZWN0b3IgLSBzZWxlY3RvciB0byBtYXRjaCBhZ2FpbnN0XG4gICAgICogQHJldHVybiB7YXJyYXl9IEFycmF5IG9mIERPTSBub2Rlc1xuICAgICAqL1xuICAgIGdldERvbU5vZGVBcnJheSA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICB2YXIgbm9kZXM7XG4gICAgICBub2RlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XG4gICAgICBpZiAoIW5vZGVzKSB7XG4gICAgICAgIG5vZGVzID0gW107XG4gICAgICB9XG4gICAgICByZXR1cm4gbm9kZXM7XG4gICAgfTtcblxuICAgIC8qXG4gICAgY2xhc3M9XCJtb2RlbCBtb2RlbC0qXCIgUmVmZXIgdG8gaW5wdXRzIGJ5IHRoZSBuYW1lIGFmdGVyIGNsYXNzIG1vZGVsLSpcbiAgICAgKi9cbiAgICBNb2RlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIEJpbmRpbmcsIHNlbGY7XG4gICAgICBzZWxmID0gdGhpcztcbiAgICAgIEJpbmRpbmcgPSBmdW5jdGlvbihlbGVtLCB2YWx1ZSkge1xuICAgICAgICBlbGVtID0gZWxlbSB8fCBudWxsO1xuICAgICAgICB2YWx1ZSA9IHZhbHVlIHx8IG51bGw7XG4gICAgICAgIHRoaXMuZWxlbSA9IGVsZW07XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5oYXNDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMub25pbnB1dCA9IGZ1bmN0aW9uKCkge307XG4gICAgICB9O1xuICAgICAgZ2V0RG9tTm9kZUFycmF5KCcubW9kZWwnKS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgZWxlbS5jbGFzc0xpc3QuZm9yRWFjaChmdW5jdGlvbihjbGFzc05hbWUpIHtcbiAgICAgICAgICB2YXIgbmFtZSwgcG9zc2libHlNYXRjaCwgdmFsdWU7XG4gICAgICAgICAgcG9zc2libHlNYXRjaCA9IGNsYXNzTmFtZS5tYXRjaCgvbW9kZWxcXC0vZyk7XG4gICAgICAgICAgaWYgKHBvc3NpYmx5TWF0Y2gpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjbGFzc05hbWUuc2xpY2UoNik7XG4gICAgICAgICAgICB2YWx1ZSA9IGVsZW0udmFsdWU7XG4gICAgICAgICAgICBpZiAobmFtZS5pbmRleE9mKCdNb250aCcpID4gLTEpIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSAtIDE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUuaW5kZXhPZignVGltZScgPiAtMSkpIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSB8fCAnMDA6MDAnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZltuYW1lXSA9IHNlbGZbbmFtZV0gfHwgbmV3IEJpbmRpbmcoZWxlbSwgdmFsdWUpO1xuICAgICAgICAgICAgZWxlbS5iaW5kaW5nID0gZWxlbS5iaW5kaW5nIHx8IHNlbGZbbmFtZV07XG4gICAgICAgICAgICBlbGVtLm9uaW5wdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgc2VsZltuYW1lXS5oYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgc2VsZltuYW1lXSA9IHNlbGZbbmFtZV0gfHwgbmV3IEJpbmRpbmcoZWxlbSwgdmFsdWUpO1xuICAgICAgICAgICAgICBzZWxmW25hbWVdLnZhbHVlID0gZWxlbS52YWx1ZTtcbiAgICAgICAgICAgICAgc2VsZi51cGRhdGVDYWxjdWxhdGlvbnMoKTtcbiAgICAgICAgICAgICAgc2VsZltuYW1lXS5vbmlucHV0KCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHNlbGYudXBkYXRlQ2FsY3VsYXRpb25zID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYuc3RhcnRNaW4gPSBzZWxmLnN0YXJ0TWluIHx8IG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuc3RhcnRUaW1lLnZhbHVlLnNwbGl0KCc6JylbMV0pO1xuICAgICAgICBzZWxmLnN0YXJ0SG91ciA9IHNlbGYuc3RhcnRIb3VyIHx8IG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuc3RhcnRUaW1lLnZhbHVlLnNwbGl0KCc6JylbMF0pO1xuICAgICAgICBzZWxmLmVuZE1pbiA9IHNlbGYuZW5kTWluIHx8IG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuZW5kVGltZS52YWx1ZS5zcGxpdCgnOicpWzFdKTtcbiAgICAgICAgc2VsZi5lbmRIb3VyID0gc2VsZi5lbmRIb3VyIHx8IG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuZW5kVGltZS52YWx1ZS5zcGxpdCgnOicpWzBdKTtcbiAgICAgICAgc2VsZi5kYXRlID0gc2VsZi5kYXRlIHx8IG5ldyBCaW5kaW5nO1xuICAgICAgICBzZWxmLmRhdGUudmFsdWUgPSBuZXcgRGF0ZShzZWxmLnN0YXJ0WWVhci52YWx1ZSwgc2VsZi5zdGFydE1vbnRoLnZhbHVlLCBzZWxmLnN0YXJ0RGF5LnZhbHVlKTtcbiAgICAgIH07XG4gICAgICBzZWxmLnVwZGF0ZUNhbGN1bGF0aW9ucygpO1xuICAgIH07XG5cbiAgICAvKlxuICAgIFRvIGNyZWF0ZSBhIHBsYWNlaG9sZGVyIGVmZmVjdC4gQXNzdW1lcyB0aGF0IGRpc3BsYXkgZWxlbWVudCBzdGFydHMgd2l0aCAncGxhY2Vob2xkZXInIGNsYXNzXG4gICAgICovXG4gICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlciA9IGZ1bmN0aW9uKGlucHV0QmluZGluZywgZGlzcGxheUVsZW0sIHBsYWNlaG9sZGVyKSB7XG4gICAgICBpZiAoZGlzcGxheUVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdwbGFjZWhvbGRlcicpKSB7XG4gICAgICAgIGRpc3BsYXlFbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYWNlaG9sZGVyJyk7XG4gICAgICB9XG4gICAgICBpZiAoaW5wdXRCaW5kaW5nLnZhbHVlID09PSAnJykge1xuICAgICAgICBpbnB1dEJpbmRpbmcudmFsdWUgPSBwbGFjZWhvbGRlcjtcbiAgICAgICAgaW5wdXRCaW5kaW5nLmhhc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgZGlzcGxheUVsZW0uY2xhc3NMaXN0LmFkZCgncGxhY2Vob2xkZXInKTtcbiAgICAgIH1cbiAgICAgIGRpc3BsYXlFbGVtLmlubmVySFRNTCA9IGlucHV0QmluZGluZy52YWx1ZTtcbiAgICB9O1xuICAgIHZhbGlkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYWxsR29vZCwgZXJyb3JNZXNzYWdlLCBwZW9wbGUsIHNlbGYsIHZhbGlkYXRpb25zO1xuICAgICAgc2VsZiA9IHRoaXM7XG4gICAgICBhbGxHb29kID0gZmFsc2U7XG4gICAgICBlcnJvck1lc3NhZ2UgPSAnUGxlYXNlIGNvcnJlY3QgdGhlIGZvbGxvd2luZyBlcnJvcnM6IDxicj4nO1xuICAgICAgcGVvcGxlID0gZ2V0RG9tTm9kZUFycmF5KCcucGVvcGxlPmRpdicpO1xuICAgICAgdmFsaWRhdGlvbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSBhIHRpdGxlLicsXG4gICAgICAgICAgdmFsaWRhdGlvbk1ldGhvZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWwudGl0bGUuaGFzQ2hhbmdlZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSBhIGRlc2NyaXB0aW9uLicsXG4gICAgICAgICAgdmFsaWRhdGlvbk1ldGhvZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWwuZGVzY3JpcHRpb24uaGFzQ2hhbmdlZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSBndWVzdHMuJyxcbiAgICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChwZW9wbGUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSB2YWxpZCBlbWFpbCBhZGRyZXNzZXMuJyxcbiAgICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhcmVSZWFsLCBlbWFpbFJlZ2V4O1xuICAgICAgICAgICAgYXJlUmVhbCA9IGZhbHNlO1xuICAgICAgICAgICAgZW1haWxSZWdleCA9IG5ldyBSZWdFeHAoJ15bLWEtejAtOX4hJCVeJipfPSt9e1xcJz9dKyguWy1hLXowLTl+ISQlXiYqXz0rfXtcXCc/XSspKkAoW2EtejAtOV9dWy1hLXowLTlfXSooLlstYS16MC05X10rKSouKGFlcm98YXJwYXxiaXp8Y29tfGNvb3B8ZWR1fGdvdnxpbmZvfGludHxtaWx8bXVzZXVtfG5hbWV8bmV0fG9yZ3xwcm98dHJhdmVsfG1vYml8W2Etel1bYS16XSl8KFswLTldezEsM30uWzAtOV17MSwzfS5bMC05XXsxLDN9LlswLTldezEsM30pKSg6WzAtOV17MSw1fSk/JCcpO1xuICAgICAgICAgICAgcGVvcGxlLmZvckVhY2goZnVuY3Rpb24oZ3Vlc3QsIGluZGV4KSB7XG4gICAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGVtYWlsUmVnZXguZXhlYyhndWVzdC52YWx1ZSk7XG4gICAgICAgICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0WydpbmRleCddID09PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICBhcmVSZWFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgYXJlUmVhbCA9IGFyZVJlYWwgJiYgdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXJlUmVhbCA9IGFyZVJlYWwgJiYgZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFyZVJlYWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdO1xuICAgICAgdmFsaWRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbih2YWwsIGluZGV4KSB7XG4gICAgICAgIGlmICh2YWwudmFsaWRhdGlvbk1ldGhvZChzZWxmKSkge1xuICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgYWxsR29vZCA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFsbEdvb2QgPSBhbGxHb29kICYmIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFsbEdvb2QgPSBhbGxHb29kICYmIGZhbHNlO1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSArIHZhbC5lcnJvck1lc3NhZ2UgKyAnPGJyPic7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlLnRyaW0oKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzVmFsaWQ6IGFsbEdvb2QsXG4gICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3JNZXNzYWdlXG4gICAgICB9O1xuICAgIH07XG4gICAgZGF5U2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24oc2VsZWN0RWxlbWVudCkge1xuICAgICAgdmFyIGRheSwgbmV3T3B0aW9uO1xuICAgICAgZGF5ID0gMTtcbiAgICAgIHdoaWxlIChkYXkgPCAzMikge1xuICAgICAgICBuZXdPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgaWYgKGRheSA8IDEwKSB7XG4gICAgICAgICAgZGF5ID0gJzAnICsgZGF5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRheSA9IGRheSArICcnO1xuICAgICAgICB9XG4gICAgICAgIG5ld09wdGlvbi5pbm5lckhUTUwgPSBkYXk7XG4gICAgICAgIHNlbGVjdEVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3T3B0aW9uKTtcbiAgICAgICAgZGF5Kys7XG4gICAgICB9XG4gICAgfSk7XG4gICAgbW9udGhTZWxlY3RvcnMgPSBnZXREb21Ob2RlQXJyYXkoJy5tb250aCcpO1xuICAgIG1vbnRoU2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24oc2VsZWN0RWxlbWVudCkge1xuICAgICAgdmFyIG1vbnRoLCBuZXdPcHRpb247XG4gICAgICBtb250aCA9IDE7XG4gICAgICB3aGlsZSAobW9udGggPCAxMykge1xuICAgICAgICBuZXdPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgaWYgKG1vbnRoIDwgMTApIHtcbiAgICAgICAgICBtb250aCA9ICcwJyArIG1vbnRoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1vbnRoID0gbW9udGggKyAnJztcbiAgICAgICAgfVxuICAgICAgICBuZXdPcHRpb24uaW5uZXJIVE1MID0gbW9udGg7XG4gICAgICAgIHNlbGVjdEVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3T3B0aW9uKTtcbiAgICAgICAgbW9udGgrKztcbiAgICAgIH1cbiAgICB9KTtcbiAgICB5ZWFyU2VsZWN0b3JzID0gZ2V0RG9tTm9kZUFycmF5KCcueWVhcicpO1xuICAgIHllYXJTZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbihzZWxlY3RFbGVtZW50KSB7XG4gICAgICB2YXIgbmV3T3B0aW9uLCB5ZWFyO1xuICAgICAgeWVhciA9IDIwMTU7XG4gICAgICB3aGlsZSAoeWVhciA8IDIwMjEpIHtcbiAgICAgICAgbmV3T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgIG5ld09wdGlvbi5pbm5lckhUTUwgPSB5ZWFyICsgJyc7XG4gICAgICAgIHNlbGVjdEVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3T3B0aW9uKTtcbiAgICAgICAgeWVhcisrO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLypcbiAgICBBZGRpbmcgZ3Vlc3RzXG4gICAgICovXG4gICAgbmV3R3Vlc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dC5uZXctZ3Vlc3QnKTtcbiAgICBwZW9wbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXR0ZW5kZWVzJyk7XG4gICAgbmV3R3Vlc3Qub25rZXlkb3duID0gZnVuY3Rpb24oZXZ0KSB7XG4gICAgICB2YXIgZGVsZXRlUGVyc29uLCBlbnRlcmVkUGVyc29uO1xuICAgICAgaWYgKGV2dC5rZXlJZGVudGlmaWVyID09PSAnRW50ZXInKSB7XG4gICAgICAgIGVudGVyZWRQZXJzb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGVsZXRlUGVyc29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGRlbGV0ZVBlcnNvbi5pbm5lckhUTUwgPSAnLSc7XG4gICAgICAgIGRlbGV0ZVBlcnNvbi5wYXJlbnQgPSBlbnRlcmVkUGVyc29uO1xuICAgICAgICBkZWxldGVQZXJzb24ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHBlb3BsZS5yZW1vdmVDaGlsZCh0aGlzLnBhcmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIGVudGVyZWRQZXJzb24uaW5uZXJIVE1MID0gbmV3R3Vlc3QudmFsdWU7XG4gICAgICAgIGVudGVyZWRQZXJzb24udmFsdWUgPSBuZXdHdWVzdC52YWx1ZTtcbiAgICAgICAgZW50ZXJlZFBlcnNvbi5hcHBlbmRDaGlsZChkZWxldGVQZXJzb24pO1xuICAgICAgICBwZW9wbGUuYXBwZW5kQ2hpbGQoZW50ZXJlZFBlcnNvbik7XG4gICAgICAgIG5ld0d1ZXN0LnZhbHVlID0gJyc7XG4gICAgICB9XG4gICAgfTtcbiAgICBtb2RlbCA9IG5ldyBNb2RlbDtcbiAgICBtb2RlbC50aXRsZS5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgdGl0bGVEaXNwbGF5O1xuICAgICAgdGl0bGVEaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRpdGxlLWRpc3BsYXknKTtcbiAgICAgIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIobW9kZWwudGl0bGUsIHRpdGxlRGlzcGxheSwgJ1VudGl0bGVkIEV2ZW50Jyk7XG4gICAgfTtcbiAgICBtb2RlbC5kZXNjcmlwdGlvbi5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgZGVzY3JpcHRpb25EaXNwbGF5O1xuICAgICAgZGVzY3JpcHRpb25EaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtZGV0YWlsLWFjdHVhbC53aGF0Jyk7XG4gICAgICBkaXNwbGF5V2l0aFBsYWNlaG9sZGVyKG1vZGVsLmRlc2NyaXB0aW9uLCBkZXNjcmlwdGlvbkRpc3BsYXksICdEZXNjcmlwdGlvbicpO1xuICAgIH07XG4gICAgbW9kZWwubG9jYXRpb24ub25pbnB1dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxvY2F0aW9uRGlzcGxheTtcbiAgICAgIGxvY2F0aW9uRGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLWRldGFpbC1hY3R1YWwud2hlcmUnKTtcbiAgICAgIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIobW9kZWwubG9jYXRpb24sIGxvY2F0aW9uRGlzcGxheSwgJ1BsYWNlJyk7XG4gICAgfTtcbiAgICB3aGVuRGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLWRldGFpbC1hY3R1YWwud2hlbicpO1xuICAgIGdldERvbU5vZGVBcnJheSgnLmlucHV0LWRhdGV0aW1lJykuZm9yRWFjaChmdW5jdGlvbihlbGVtKSB7XG4gICAgICBlbGVtLmJpbmRpbmcub25pbnB1dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdGltZVRvRGlzcGxheTtcbiAgICAgICAgdGltZVRvRGlzcGxheSA9IG1vZGVsLmRhdGUudmFsdWUudG9EYXRlU3RyaW5nKCkgKyAnIGZyb20gJyArIG1vZGVsLnN0YXJ0VGltZS52YWx1ZSArICcgdG8gJyArIG1vZGVsLmVuZFRpbWUudmFsdWU7XG4gICAgICAgIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIoe1xuICAgICAgICAgIHZhbHVlOiB0aW1lVG9EaXNwbGF5XG4gICAgICAgIH0sIHdoZW5EaXNwbGF5LCAnVGltZScpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgICBjcmVhdGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdidXR0b24jY3JlYXRlJyk7XG4gICAgY3JlYXRlQnV0dG9uLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBlcnJvck1lc3NhZ2UsIHZhbGlkU3RhdGU7XG4gICAgICB2YWxpZFN0YXRlID0gdmFsaWRhdGUoKTtcbiAgICAgIGlmICghdmFsaWRTdGF0ZS5pc1ZhbGlkKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcnJvci1tZXNzYWdlJyk7XG4gICAgICAgIGVycm9yTWVzc2FnZS5pbm5lckhUTUwgPSB2YWxpZFN0YXRlLmVycm9yTWVzc2FnZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFsZXJ0KCdWYWxpZCBmb3JtLiBUaGFua3MgZm9yIHN1Ym1pdHRpbmchJyk7XG4gICAgICB9XG4gICAgfTtcbiAgfSkoKTtcblxufSkuY2FsbCh0aGlzKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
