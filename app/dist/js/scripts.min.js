(function(){var e;e=function(){var e,n,t,a,i,r,o,l,u,c,d,s;t=i(".day"),i=function(e){var n;return n=Array.prototype.slice.apply(document.querySelectorAll(e)),n||(n=[]),n},e=function(){var e,n;n=this,e=function(e,n){e=e||null,n=n||null,this.elem=e,this.value=n,this.hasChanged=!1,this.oninput=function(){}},i(".model").forEach(function(t){t.classList.forEach(function(a){var i,r,o;r=a.match(/model\-/g),r&&(i=a.slice(6),o=t.value,i.indexOf("Month")>-1?o-=1:i.indexOf(!1)&&(o=o||"00:00"),n[i]=n[i]||new e(t,o),t.binding=t.binding||n[i],t.oninput=function(){n[i].hasChanged=!0,n[i]=n[i]||new e(t,o),n[i].value=t.value,n.updateCalculations(),n[i].oninput()})})}),n.updateCalculations=function(){n.startMin=n.startMin||new e(null,n.startTime.value.split(":")[1]),n.startHour=n.startHour||new e(null,n.startTime.value.split(":")[0]),n.endMin=n.endMin||new e(null,n.endTime.value.split(":")[1]),n.endHour=n.endHour||new e(null,n.endTime.value.split(":")[0]),n.date=n.date||new e,n.date.value=new Date(n.startYear.value,n.startMonth.value,n.startDay.value)},n.updateCalculations()},a=function(e,n,t){n.classList.contains("placeholder")&&n.classList.remove("placeholder"),""===e.value&&(e.value=t,e.hasChanged=!1,n.classList.add("placeholder")),n.innerHTML=e.value},c=function(){var e,n,t,a,o;return a=this,e=!1,n="Please correct the following errors: <br>",t=i(".people>div"),o=[{errorMessage:"Please include a title.",validationMethod:function(){return r.title.hasChanged}},{errorMessage:"Please include a description.",validationMethod:function(){return r.description.hasChanged}},{errorMessage:"Please include guests.",validationMethod:function(){return t.length>0?!0:!1}},{errorMessage:"Please include valid email addresses.",validationMethod:function(){var e,n;return e=!1,n=new RegExp("^[-a-z0-9~!$%^&*_=+}{'?]+(.[-a-z0-9~!$%^&*_=+}{'?]+)*@([a-z0-9_][-a-z0-9_]*(.[-a-z0-9_]+)*.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}))(:[0-9]{1,5})?$"),t.forEach(function(t,a){var i;i=n.exec(t.value),e=i&&0===i.index?0===a?!0:e&&!0:e&&!1}),e}}],o.forEach(function(t,i){t.validationMethod(a)?e=0===i?!0:e&&!0:(e=e&&!1,n=n+t.errorMessage+"<br>")}),n=n.trim(),{isValid:e,errorMessage:n}},t.forEach(function(e){var n,t;for(n=1;32>n;)t=document.createElement("option"),10>n?n="0"+n:n+="",t.innerHTML=n,e.appendChild(t),n++}),o=i(".month"),o.forEach(function(e){var n,t;for(n=1;13>n;)t=document.createElement("option"),10>n?n="0"+n:n+="",t.innerHTML=n,e.appendChild(t),n++}),s=i(".year"),s.forEach(function(e){var n,t;for(t=2015;2021>t;)n=document.createElement("option"),n.innerHTML=t+"",e.appendChild(n),t++}),l=document.querySelector("input.new-guest"),u=document.querySelector(".attendees"),l.onkeydown=function(e){var n,t;"Enter"===e.keyIdentifier&&(t=document.createElement("div"),n=document.createElement("button"),n.innerHTML="-",n.parent=t,n.onclick=function(){u.removeChild(this.parent)},t.innerHTML=l.value,t.value=l.value,t.appendChild(n),u.appendChild(t),l.value="")},r=new e,r.title.oninput=function(){var e;e=document.querySelector(".title-display"),a(r.title,e,"Untitled Event")},r.description.oninput=function(){var e;e=document.querySelector(".card-detail-actual.what"),a(r.description,e,"Description")},r.location.oninput=function(){var e;e=document.querySelector(".card-detail-actual.where"),a(r.location,e,"Place")},d=document.querySelector(".card-detail-actual.when"),i(".input-datetime").forEach(function(e){e.binding.oninput=function(){var e;e=r.date.value.toDateString()+" from "+r.startTime.value+" to "+r.endTime.value,a({value:e},d,"Time")}}),n=document.querySelector("button#create"),n.onclick=function(){var e,n;n=c(),n.isValid?alert("Valid form. Thanks for submitting!"):(e=document.querySelector(".error-message"),e.innerHTML=n.errorMessage)}}()}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uY29mZmVlIiwic2NyaXB0cy5taW4uanMiXSwibmFtZXMiOlsiQVBQIiwiTW9kZWwiLCJjcmVhdGVCdXR0b24iLCJkYXlTZWxlY3RvcnMiLCJkaXNwbGF5V2l0aFBsYWNlaG9sZGVyIiwiZ2V0RG9tTm9kZUFycmF5IiwibW9kZWwiLCJtb250aFNlbGVjdG9ycyIsIm5ld0d1ZXN0IiwicGVvcGxlIiwidmFsaWRhdGUiLCJ3aGVuRGlzcGxheSIsInllYXJTZWxlY3RvcnMiLCJzZWxlY3RvciIsIm5vZGVzIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJzbGljZSIsImFwcGx5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiQmluZGluZyIsInNlbGYiLCJ0aGlzIiwiZWxlbSIsInZhbHVlIiwiaGFzQ2hhbmdlZCIsIm9uaW5wdXQiLCJmb3JFYWNoIiwiY2xhc3NMaXN0IiwiY2xhc3NOYW1lIiwibmFtZSIsInBvc3NpYmx5TWF0Y2giLCJtYXRjaCIsImluZGV4T2YiLCJiaW5kaW5nIiwidXBkYXRlQ2FsY3VsYXRpb25zIiwic3RhcnRNaW4iLCJzdGFydFRpbWUiLCJzcGxpdCIsInN0YXJ0SG91ciIsImVuZE1pbiIsImVuZFRpbWUiLCJlbmRIb3VyIiwiZGF0ZSIsIkRhdGUiLCJzdGFydFllYXIiLCJzdGFydE1vbnRoIiwic3RhcnREYXkiLCJpbnB1dEJpbmRpbmciLCJkaXNwbGF5RWxlbSIsInBsYWNlaG9sZGVyIiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGQiLCJpbm5lckhUTUwiLCJhbGxHb29kIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbnMiLCJ2YWxpZGF0aW9uTWV0aG9kIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImxlbmd0aCIsImFyZVJlYWwiLCJlbWFpbFJlZ2V4IiwiUmVnRXhwIiwiZ3Vlc3QiLCJpbmRleCIsInJlc3VsdCIsImV4ZWMiLCJ2YWwiLCJ0cmltIiwiaXNWYWxpZCIsInNlbGVjdEVsZW1lbnQiLCJkYXkiLCJuZXdPcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJtb250aCIsInllYXIiLCJxdWVyeVNlbGVjdG9yIiwib25rZXlkb3duIiwiZXZ0IiwiZGVsZXRlUGVyc29uIiwiZW50ZXJlZFBlcnNvbiIsImtleUlkZW50aWZpZXIiLCJwYXJlbnQiLCJvbmNsaWNrIiwicmVtb3ZlQ2hpbGQiLCJ0aXRsZURpc3BsYXkiLCJkZXNjcmlwdGlvbkRpc3BsYXkiLCJsb2NhdGlvbiIsImxvY2F0aW9uRGlzcGxheSIsInRpbWVUb0Rpc3BsYXkiLCJ0b0RhdGVTdHJpbmciLCJ2YWxpZFN0YXRlIiwiYWxlcnQiLCJjYWxsIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUFBLEdBQUFBLEVBQUFBLEdBQVMsV0FFUCxHQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxDQUlBVCxHQUFlRSxFQUFnQixRQVEvQkEsRUFBa0IsU0FBQ1EsR0FDakIsR0FBQUMsRUNPRSxPRFBGQSxHQUFRQyxNQUFLQyxVQUFFQyxNQUFNQyxNQUFNQyxTQUFTQyxpQkFBaUJQLElBQ2pEQyxJQUNGQSxNQUNGQSxHQU1GYixFQUFRLFdBQ04sR0FBQW9CLEdBQUFDLENBQUFBLEdBQU9DLEtBR1BGLEVBQVUsU0FBQ0csRUFBTUMsR0FDZkQsRUFBT0EsR0FBUSxLQUNmQyxFQUFRQSxHQUFTLEtBQ2pCRixLQUFDQyxLQUFPQSxFQUNSRCxLQUFDRSxNQUFRQSxFQUNURixLQUFDRyxZQUFhLEVBRWRILEtBQUNJLFFBQVUsY0FJYnRCLEVBQWdCLFVBQVV1QixRQUFRLFNBQUNKLEdBQ2pDQSxFQUFLSyxVQUFVRCxRQUFRLFNBQUNFLEdBQ3RCLEdBQUFDLEdBQUFDLEVBQUFQLENBQUFPLEdBQWdCRixFQUFVRyxNQUFNLFlBQzdCRCxJQUVERCxFQUFPRCxFQUFVYixNQUFNLEdBQ3ZCUSxFQUFRRCxFQUFLQyxNQUVWTSxFQUFLRyxRQUFRLFNBQVcsR0FDekJULEdBQWdCLEVBQ1ZNLEVBQUtHLFNBQVEsS0FDbkJULEVBQVFBLEdBQVMsU0FDbkJILEVBQUtTLEdBQVFULEVBQUtTLElBQWEsR0FBQVYsR0FBUUcsRUFBTUMsR0FDN0NELEVBQUtXLFFBQVVYLEVBQUtXLFNBQVdiLEVBQUtTLEdBR3BDUCxFQUFLRyxRQUFVLFdBQ2JMLEVBQUtTLEdBQU1MLFlBQWEsRUFDeEJKLEVBQUtTLEdBQVFULEVBQUtTLElBQWEsR0FBQVYsR0FBUUcsRUFBTUMsR0FDN0NILEVBQUtTLEdBQU1OLE1BQVFELEVBQUtDLE1BQ3hCSCxFQUFLYyxxQkFFTGQsRUFBS1MsR0FBTUosZ0JBTW5CTCxFQUFLYyxtQkFBcUIsV0FDeEJkLEVBQUtlLFNBQVdmLEVBQUtlLFVBQWdCLEdBQUFoQixHQUFRLEtBQU1DLEVBQUtnQixVQUFVYixNQUFNYyxNQUFNLEtBQUssSUFDbkZqQixFQUFLa0IsVUFBWWxCLEVBQUtrQixXQUFpQixHQUFBbkIsR0FBUSxLQUFNQyxFQUFLZ0IsVUFBVWIsTUFBTWMsTUFBTSxLQUFLLElBQ3JGakIsRUFBS21CLE9BQVNuQixFQUFLbUIsUUFBYyxHQUFBcEIsR0FBUSxLQUFNQyxFQUFLb0IsUUFBUWpCLE1BQU1jLE1BQU0sS0FBSyxJQUM3RWpCLEVBQUtxQixRQUFVckIsRUFBS3FCLFNBQWUsR0FBQXRCLEdBQVEsS0FBTUMsRUFBS29CLFFBQVFqQixNQUFNYyxNQUFNLEtBQUssSUFDL0VqQixFQUFLc0IsS0FBT3RCLEVBQUtzQixNQUFRLEdBQUl2QixHQUM3QkMsRUFBS3NCLEtBQUtuQixNQUFZLEdBQUFvQixNQUFLdkIsRUFBS3dCLFVBQVVyQixNQUFPSCxFQUFLeUIsV0FBV3RCLE1BQU9ILEVBQUswQixTQUFTdkIsUUFHeEZILEVBQUtjLHNCQU9QaEMsRUFBeUIsU0FBQzZDLEVBQWNDLEVBQWFDLEdBQ2hERCxFQUFZckIsVUFBVXVCLFNBQVMsZ0JBQ2hDRixFQUFZckIsVUFBVXdCLE9BQU8sZUFDTixLQUF0QkosRUFBYXhCLFFBQ2R3QixFQUFheEIsTUFBUTBCLEVBRXJCRixFQUFhdkIsWUFBYSxFQUMxQndCLEVBQVlyQixVQUFVeUIsSUFBSSxnQkFDNUJKLEVBQVlLLFVBQVlOLEVBQWF4QixPQUd2Q2YsRUFBVyxXQUNULEdBQUE4QyxHQUFBQyxFQUFBaEQsRUFBQWEsRUFBQW9DLENDdURFLE9EdkRGcEMsR0FBT0MsS0FDUGlDLEdBQVUsRUFDVkMsRUFBZSw0Q0FDZmhELEVBQVNKLEVBQWdCLGVBQ3pCcUQsSUFFSUQsYUFBYywwQkFDZEUsaUJBQWtCLFdDSmQsTURLRnJELEdBQU1zRCxNQUFNbEMsY0FJZCtCLGFBQWMsZ0NBQ2RFLGlCQUFrQixXQ0xkLE1ETUZyRCxHQUFNdUQsWUFBWW5DLGNBSXBCK0IsYUFBYyx5QkFDZEUsaUJBQWtCLFdBQ2hCLE1BQUdsRCxHQUFPcUQsT0FBUyxHQUNqQixHQUVBLEtBSUpMLGFBQWMsd0NBQ2RFLGlCQUFrQixXQUNoQixHQUFBSSxHQUFBQyxDQ1NFLE9EVEZELElBQVUsRUFDVkMsRUFBaUIsR0FBQUMsUUFBTyx5UEFDeEJ4RCxFQUFPbUIsUUFBUSxTQUFDc0MsRUFBT0MsR0FDckIsR0FBQUMsRUFBQUEsR0FBU0osRUFBV0ssS0FBS0gsRUFBTXpDLE9BRzNCc0MsRUFGREssR0FBOEIsSUFBbkJBLEVBQU8sTUFDUCxJQUFURCxHQUNTLEVBRUFKLElBQVksRUFFZEEsSUFBWSxJQUUxQkEsS0FJTkwsRUFBWTlCLFFBQVEsU0FBQzBDLEVBQUtILEdBQ3JCRyxFQUFJWCxpQkFBaUJyQyxHQUVwQmtDLEVBRFUsSUFBVFcsR0FDUyxFQUVBWCxJQUFZLEdBRXhCQSxFQUFVQSxJQUFZLEVBQ3RCQyxFQUFlQSxFQUFlYSxFQUFJYixhQUFlLFVBRXJEQSxFQUFlQSxFQUFhYyxRQUUxQkMsUUFBU2hCLEVBQ1RDLGFBQWNBLElBR2xCdEQsRUFBYXlCLFFBQVEsU0FBQzZDLEdBQ3BCLEdBQUFDLEdBQUFDLENBQ0EsS0FEQUQsRUFBTSxFQUNNLEdBQU5BLEdBQ0pDLEVBQVl4RCxTQUFTeUQsY0FBYyxVQUMxQixHQUFORixFQUNEQSxFQUFNLElBQU1BLEVBRVpBLEdBQVksR0FDZEMsRUFBVXBCLFVBQVltQixFQUN0QkQsRUFBY0ksWUFBWUYsR0FDMUJELE1BRUpuRSxFQUFpQkYsRUFBZ0IsVUFDakNFLEVBQWVxQixRQUFRLFNBQUM2QyxHQUN0QixHQUFBSyxHQUFBSCxDQUNBLEtBREFHLEVBQVEsRUFDTSxHQUFSQSxHQUNKSCxFQUFZeEQsU0FBU3lELGNBQWMsVUFDeEIsR0FBUkUsRUFDREEsRUFBUSxJQUFNQSxFQUVkQSxHQUFnQixHQUNsQkgsRUFBVXBCLFVBQVl1QixFQUN0QkwsRUFBY0ksWUFBWUYsR0FDMUJHLE1BRUpsRSxFQUFnQlAsRUFBZ0IsU0FDaENPLEVBQWNnQixRQUFRLFNBQUM2QyxHQUNyQixHQUFBRSxHQUFBSSxDQUNBLEtBREFBLEVBQU8sS0FDTSxLQUFQQSxHQUNKSixFQUFZeEQsU0FBU3lELGNBQWMsVUFDbkNELEVBQVVwQixVQUFZd0IsRUFBTyxHQUM3Qk4sRUFBY0ksWUFBWUYsR0FDMUJJLE1BT0p2RSxFQUFXVyxTQUFTNkQsY0FBYyxtQkFDbEN2RSxFQUFTVSxTQUFTNkQsY0FBYyxjQUVoQ3hFLEVBQVN5RSxVQUFZLFNBQUNDLEdBQ3BCLEdBQUFDLEdBQUFDLENBQXdCLFdBQXJCRixFQUFJRyxnQkFDTEQsRUFBZ0JqRSxTQUFTeUQsY0FBYyxPQUN2Q08sRUFBZWhFLFNBQVN5RCxjQUFjLFVBQ3RDTyxFQUFhNUIsVUFBWSxJQUN6QjRCLEVBQWFHLE9BQVNGLEVBRXRCRCxFQUFhSSxRQUFVLFdBQ3JCOUUsRUFBTytFLFlBQVlqRSxLQUFDK0QsU0FHdEJGLEVBQWM3QixVQUFZL0MsRUFBU2lCLE1BQ25DMkQsRUFBYzNELE1BQVFqQixFQUFTaUIsTUFFL0IyRCxFQUFjUCxZQUFZTSxHQUMxQjFFLEVBQU9vRSxZQUFZTyxHQUNuQjVFLEVBQVNpQixNQUFRLEtBR3JCbkIsRUFBUSxHQUFJTCxHQUdaSyxFQUFNc0QsTUFBTWpDLFFBQVUsV0FDcEIsR0FBQThELEVBQUFBLEdBQWV0RSxTQUFTNkQsY0FBYyxrQkFDdEM1RSxFQUF1QkUsRUFBTXNELE1BQU82QixFQUFjLG1CQUdwRG5GLEVBQU11RCxZQUFZbEMsUUFBVSxXQUMxQixHQUFBK0QsRUFBQUEsR0FBcUJ2RSxTQUFTNkQsY0FBYyw0QkFDNUM1RSxFQUF1QkUsRUFBTXVELFlBQWE2QixFQUFvQixnQkFHaEVwRixFQUFNcUYsU0FBU2hFLFFBQVUsV0FDdkIsR0FBQWlFLEVBQUFBLEdBQWtCekUsU0FBUzZELGNBQWMsNkJBQ3pDNUUsRUFBdUJFLEVBQU1xRixTQUFVQyxFQUFpQixVQUcxRGpGLEVBQWNRLFNBQVM2RCxjQUFjLDRCQUNyQzNFLEVBQWdCLG1CQUFtQnVCLFFBQVEsU0FBQ0osR0FFMUNBLEVBQUtXLFFBQVFSLFFBQVUsV0FFckIsR0FBQWtFLEVBQUFBLEdBQWdCdkYsRUFBTXNDLEtBQUtuQixNQUFNcUUsZUFBaUIsU0FBV3hGLEVBQU1nQyxVQUFVYixNQUFRLE9BQVNuQixFQUFNb0MsUUFBUWpCLE1BQzVHckIsR0FBeUJxQixNQUFPb0UsR0FBaUJsRixFQUFhLFdBSWxFVCxFQUFlaUIsU0FBUzZELGNBQWMsaUJBRXRDOUUsRUFBYXFGLFFBQVUsV0FDckIsR0FBQTlCLEdBQUFzQyxDQUFBQSxHQUFhckYsSUFDVHFGLEVBQVd2QixRQUlid0IsTUFBTSx1Q0FITnZDLEVBQWV0QyxTQUFTNkQsY0FBYyxrQkFDdEN2QixFQUFhRixVQUFZd0MsRUFBV3RDLG9CQ1F2Q3dDLEtBQUsxRSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIkFQUCA9IGRvIC0+XG5cbiAgIyMjXG4gIEdlbmVyYXRlIGFsbCB0aGUgb3B0aW9ucyBmb3IgdGhlIGRhdGUgZW50cmllc1xuICAjIyNcblxuICBkYXlTZWxlY3RvcnMgPSBnZXREb21Ob2RlQXJyYXkoJy5kYXknKVxuXG4gICMjIypcbiAgIyBDcmVhdGVzIGFuIEFycmF5IG9mIERPTSBub2RlcyB0aGF0IG1hdGNoIHRoZSBzZWxlY3RvclxuICAjIEBwYXJhbSBzZWxlY3RvciB7c3RyaW5nfSBDU1Mgc2VsZWN0b3IgLSBzZWxlY3RvciB0byBtYXRjaCBhZ2FpbnN0XG4gICMgQHJldHVybiB7YXJyYXl9IEFycmF5IG9mIERPTSBub2Rlc1xuICAjIyNcblxuICBnZXREb21Ob2RlQXJyYXkgPSAoc2VsZWN0b3IpIC0+XG4gICAgbm9kZXMgPSBBcnJheTo6c2xpY2UuYXBwbHkoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpXG4gICAgaWYgIW5vZGVzXG4gICAgICBub2RlcyA9IFtdXG4gICAgbm9kZXNcblxuICAjIyNcbiAgY2xhc3M9XCJtb2RlbCBtb2RlbC0qXCIgUmVmZXIgdG8gaW5wdXRzIGJ5IHRoZSBuYW1lIGFmdGVyIGNsYXNzIG1vZGVsLSpcbiAgIyMjXG5cbiAgTW9kZWwgPSAtPlxuICAgIHNlbGYgPSB0aGlzXG4gICAgIyBwdWxscyB2YWx1ZXMgZnJvbSBlbGVtcyBvZiBjbGFzcz1cIm1vZGVsIG1vZGVsLSpcIiB0byBjcmVhdGUgTW9kZWwncyByYXcgaW5mbyBhbmQgc2V0IHVwIDEtd2F5IGJpbmRpbmdcblxuICAgIEJpbmRpbmcgPSAoZWxlbSwgdmFsdWUpIC0+XG4gICAgICBlbGVtID0gZWxlbSBvciBudWxsXG4gICAgICB2YWx1ZSA9IHZhbHVlIG9yIG51bGxcbiAgICAgIEBlbGVtID0gZWxlbVxuICAgICAgQHZhbHVlID0gdmFsdWVcbiAgICAgIEBoYXNDaGFuZ2VkID0gZmFsc2VcblxuICAgICAgQG9uaW5wdXQgPSAtPlxuXG4gICAgICByZXR1cm5cblxuICAgIGdldERvbU5vZGVBcnJheSgnLm1vZGVsJykuZm9yRWFjaCAoZWxlbSkgLT5cbiAgICAgIGVsZW0uY2xhc3NMaXN0LmZvckVhY2ggKGNsYXNzTmFtZSkgLT5cbiAgICAgICAgcG9zc2libHlNYXRjaCA9IGNsYXNzTmFtZS5tYXRjaCgvbW9kZWxcXC0vZylcbiAgICAgICAgaWYgcG9zc2libHlNYXRjaFxuICAgICAgICAgICMgY3JlYXRlIHRoZSBNb2RlbCB2YWx1ZVxuICAgICAgICAgIG5hbWUgPSBjbGFzc05hbWUuc2xpY2UoNilcbiAgICAgICAgICB2YWx1ZSA9IGVsZW0udmFsdWVcbiAgICAgICAgICAjIHNldCBkZWZhdWx0IHZhbHVlc1xuICAgICAgICAgIGlmIG5hbWUuaW5kZXhPZignTW9udGgnKSA+IC0xXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIC0gMVxuICAgICAgICAgIGVsc2UgaWYgbmFtZS5pbmRleE9mKCdUaW1lJyA+IC0xKVxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSBvciAnMDA6MDAnXG4gICAgICAgICAgc2VsZltuYW1lXSA9IHNlbGZbbmFtZV0gb3IgbmV3IEJpbmRpbmcoZWxlbSwgdmFsdWUpXG4gICAgICAgICAgZWxlbS5iaW5kaW5nID0gZWxlbS5iaW5kaW5nIG9yIHNlbGZbbmFtZV1cbiAgICAgICAgICAjIGJpbmQgZGF0YSBvbmlucHV0XG5cbiAgICAgICAgICBlbGVtLm9uaW5wdXQgPSAtPlxuICAgICAgICAgICAgc2VsZltuYW1lXS5oYXNDaGFuZ2VkID0gdHJ1ZVxuICAgICAgICAgICAgc2VsZltuYW1lXSA9IHNlbGZbbmFtZV0gb3IgbmV3IEJpbmRpbmcoZWxlbSwgdmFsdWUpXG4gICAgICAgICAgICBzZWxmW25hbWVdLnZhbHVlID0gZWxlbS52YWx1ZVxuICAgICAgICAgICAgc2VsZi51cGRhdGVDYWxjdWxhdGlvbnMoKVxuICAgICAgICAgICAgIyBmb3IgY2FsbGJhY2tzXG4gICAgICAgICAgICBzZWxmW25hbWVdLm9uaW5wdXQoKVxuICAgICAgICAgICAgcmV0dXJuXG5cbiAgICAgICAgcmV0dXJuXG4gICAgICByZXR1cm5cblxuICAgIHNlbGYudXBkYXRlQ2FsY3VsYXRpb25zID0gLT5cbiAgICAgIHNlbGYuc3RhcnRNaW4gPSBzZWxmLnN0YXJ0TWluIG9yIG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuc3RhcnRUaW1lLnZhbHVlLnNwbGl0KCc6JylbMV0pXG4gICAgICBzZWxmLnN0YXJ0SG91ciA9IHNlbGYuc3RhcnRIb3VyIG9yIG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuc3RhcnRUaW1lLnZhbHVlLnNwbGl0KCc6JylbMF0pXG4gICAgICBzZWxmLmVuZE1pbiA9IHNlbGYuZW5kTWluIG9yIG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuZW5kVGltZS52YWx1ZS5zcGxpdCgnOicpWzFdKVxuICAgICAgc2VsZi5lbmRIb3VyID0gc2VsZi5lbmRIb3VyIG9yIG5ldyBCaW5kaW5nKG51bGwsIHNlbGYuZW5kVGltZS52YWx1ZS5zcGxpdCgnOicpWzBdKVxuICAgICAgc2VsZi5kYXRlID0gc2VsZi5kYXRlIG9yIG5ldyBCaW5kaW5nXG4gICAgICBzZWxmLmRhdGUudmFsdWUgPSBuZXcgRGF0ZShzZWxmLnN0YXJ0WWVhci52YWx1ZSwgc2VsZi5zdGFydE1vbnRoLnZhbHVlLCBzZWxmLnN0YXJ0RGF5LnZhbHVlKVxuICAgICAgcmV0dXJuXG5cbiAgICBzZWxmLnVwZGF0ZUNhbGN1bGF0aW9ucygpXG4gICAgcmV0dXJuXG5cbiAgIyMjXG4gIFRvIGNyZWF0ZSBhIHBsYWNlaG9sZGVyIGVmZmVjdC4gQXNzdW1lcyB0aGF0IGRpc3BsYXkgZWxlbWVudCBzdGFydHMgd2l0aCAncGxhY2Vob2xkZXInIGNsYXNzXG4gICMjI1xuXG4gIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIgPSAoaW5wdXRCaW5kaW5nLCBkaXNwbGF5RWxlbSwgcGxhY2Vob2xkZXIpIC0+XG4gICAgaWYgZGlzcGxheUVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdwbGFjZWhvbGRlcicpXG4gICAgICBkaXNwbGF5RWxlbS5jbGFzc0xpc3QucmVtb3ZlICdwbGFjZWhvbGRlcidcbiAgICBpZiBpbnB1dEJpbmRpbmcudmFsdWUgPT0gJydcbiAgICAgIGlucHV0QmluZGluZy52YWx1ZSA9IHBsYWNlaG9sZGVyXG4gICAgICAjIGxldCB0aGUgbW9kZWwga25vdyB0aGF0IGlucHV0IGhhcyBnb25lIGJhY2sgdG8gZGVmYXVsdFxuICAgICAgaW5wdXRCaW5kaW5nLmhhc0NoYW5nZWQgPSBmYWxzZVxuICAgICAgZGlzcGxheUVsZW0uY2xhc3NMaXN0LmFkZCAncGxhY2Vob2xkZXInXG4gICAgZGlzcGxheUVsZW0uaW5uZXJIVE1MID0gaW5wdXRCaW5kaW5nLnZhbHVlXG4gICAgcmV0dXJuXG5cbiAgdmFsaWRhdGUgPSAtPlxuICAgIHNlbGYgPSB0aGlzXG4gICAgYWxsR29vZCA9IGZhbHNlXG4gICAgZXJyb3JNZXNzYWdlID0gJ1BsZWFzZSBjb3JyZWN0IHRoZSBmb2xsb3dpbmcgZXJyb3JzOiA8YnI+J1xuICAgIHBlb3BsZSA9IGdldERvbU5vZGVBcnJheSgnLnBlb3BsZT5kaXYnKVxuICAgIHZhbGlkYXRpb25zID0gW1xuICAgICAge1xuICAgICAgICBlcnJvck1lc3NhZ2U6ICdQbGVhc2UgaW5jbHVkZSBhIHRpdGxlLidcbiAgICAgICAgdmFsaWRhdGlvbk1ldGhvZDogLT5cbiAgICAgICAgICBtb2RlbC50aXRsZS5oYXNDaGFuZ2VkXG5cbiAgICAgIH1cbiAgICAgIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlOiAnUGxlYXNlIGluY2x1ZGUgYSBkZXNjcmlwdGlvbi4nXG4gICAgICAgIHZhbGlkYXRpb25NZXRob2Q6IC0+XG4gICAgICAgICAgbW9kZWwuZGVzY3JpcHRpb24uaGFzQ2hhbmdlZFxuXG4gICAgICB9XG4gICAgICB7XG4gICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIGd1ZXN0cy4nXG4gICAgICAgIHZhbGlkYXRpb25NZXRob2Q6IC0+XG4gICAgICAgICAgaWYgcGVvcGxlLmxlbmd0aCA+IDBcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICBmYWxzZVxuXG4gICAgICB9XG4gICAgICB7XG4gICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIHZhbGlkIGVtYWlsIGFkZHJlc3Nlcy4nXG4gICAgICAgIHZhbGlkYXRpb25NZXRob2Q6IC0+XG4gICAgICAgICAgYXJlUmVhbCA9IGZhbHNlXG4gICAgICAgICAgZW1haWxSZWdleCA9IG5ldyBSZWdFeHAoJ15bLWEtejAtOX4hJCVeJipfPSt9e1xcJz9dKyguWy1hLXowLTl+ISQlXiYqXz0rfXtcXCc/XSspKkAoW2EtejAtOV9dWy1hLXowLTlfXSooLlstYS16MC05X10rKSouKGFlcm98YXJwYXxiaXp8Y29tfGNvb3B8ZWR1fGdvdnxpbmZvfGludHxtaWx8bXVzZXVtfG5hbWV8bmV0fG9yZ3xwcm98dHJhdmVsfG1vYml8W2Etel1bYS16XSl8KFswLTldezEsM30uWzAtOV17MSwzfS5bMC05XXsxLDN9LlswLTldezEsM30pKSg6WzAtOV17MSw1fSk/JCcpXG4gICAgICAgICAgcGVvcGxlLmZvckVhY2ggKGd1ZXN0LCBpbmRleCkgLT5cbiAgICAgICAgICAgIHJlc3VsdCA9IGVtYWlsUmVnZXguZXhlYyhndWVzdC52YWx1ZSlcbiAgICAgICAgICAgIGlmIHJlc3VsdCBhbmQgcmVzdWx0WydpbmRleCddID09IDBcbiAgICAgICAgICAgICAgaWYgaW5kZXggPT0gMFxuICAgICAgICAgICAgICAgIGFyZVJlYWwgPSB0cnVlXG4gICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBhcmVSZWFsID0gYXJlUmVhbCBhbmQgdHJ1ZVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICBhcmVSZWFsID0gYXJlUmVhbCBhbmQgZmFsc2VcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgIGFyZVJlYWxcblxuICAgICAgfVxuICAgIF1cbiAgICB2YWxpZGF0aW9ucy5mb3JFYWNoICh2YWwsIGluZGV4KSAtPlxuICAgICAgaWYgdmFsLnZhbGlkYXRpb25NZXRob2Qoc2VsZilcbiAgICAgICAgaWYgaW5kZXggPT0gMFxuICAgICAgICAgIGFsbEdvb2QgPSB0cnVlXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBhbGxHb29kID0gYWxsR29vZCBhbmQgdHJ1ZVxuICAgICAgZWxzZVxuICAgICAgICBhbGxHb29kID0gYWxsR29vZCBhbmQgZmFsc2VcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlICsgdmFsLmVycm9yTWVzc2FnZSArICc8YnI+J1xuICAgICAgcmV0dXJuXG4gICAgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlLnRyaW0oKVxuICAgIHtcbiAgICAgIGlzVmFsaWQ6IGFsbEdvb2RcbiAgICAgIGVycm9yTWVzc2FnZTogZXJyb3JNZXNzYWdlXG4gICAgfVxuXG4gIGRheVNlbGVjdG9ycy5mb3JFYWNoIChzZWxlY3RFbGVtZW50KSAtPlxuICAgIGRheSA9IDFcbiAgICB3aGlsZSBkYXkgPCAzMlxuICAgICAgbmV3T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJylcbiAgICAgIGlmIGRheSA8IDEwXG4gICAgICAgIGRheSA9ICcwJyArIGRheVxuICAgICAgZWxzZVxuICAgICAgICBkYXkgPSBkYXkgKyAnJ1xuICAgICAgbmV3T3B0aW9uLmlubmVySFRNTCA9IGRheVxuICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmRDaGlsZCBuZXdPcHRpb25cbiAgICAgIGRheSsrXG4gICAgcmV0dXJuXG4gIG1vbnRoU2VsZWN0b3JzID0gZ2V0RG9tTm9kZUFycmF5KCcubW9udGgnKVxuICBtb250aFNlbGVjdG9ycy5mb3JFYWNoIChzZWxlY3RFbGVtZW50KSAtPlxuICAgIG1vbnRoID0gMVxuICAgIHdoaWxlIG1vbnRoIDwgMTNcbiAgICAgIG5ld09wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXG4gICAgICBpZiBtb250aCA8IDEwXG4gICAgICAgIG1vbnRoID0gJzAnICsgbW9udGhcbiAgICAgIGVsc2VcbiAgICAgICAgbW9udGggPSBtb250aCArICcnXG4gICAgICBuZXdPcHRpb24uaW5uZXJIVE1MID0gbW9udGhcbiAgICAgIHNlbGVjdEVsZW1lbnQuYXBwZW5kQ2hpbGQgbmV3T3B0aW9uXG4gICAgICBtb250aCsrXG4gICAgcmV0dXJuXG4gIHllYXJTZWxlY3RvcnMgPSBnZXREb21Ob2RlQXJyYXkoJy55ZWFyJylcbiAgeWVhclNlbGVjdG9ycy5mb3JFYWNoIChzZWxlY3RFbGVtZW50KSAtPlxuICAgIHllYXIgPSAyMDE1XG4gICAgd2hpbGUgeWVhciA8IDIwMjFcbiAgICAgIG5ld09wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXG4gICAgICBuZXdPcHRpb24uaW5uZXJIVE1MID0geWVhciArICcnXG4gICAgICBzZWxlY3RFbGVtZW50LmFwcGVuZENoaWxkIG5ld09wdGlvblxuICAgICAgeWVhcisrXG4gICAgcmV0dXJuXG5cbiAgIyMjXG4gIEFkZGluZyBndWVzdHNcbiAgIyMjXG5cbiAgbmV3R3Vlc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dC5uZXctZ3Vlc3QnKVxuICBwZW9wbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXR0ZW5kZWVzJylcblxuICBuZXdHdWVzdC5vbmtleWRvd24gPSAoZXZ0KSAtPlxuICAgIGlmIGV2dC5rZXlJZGVudGlmaWVyID09ICdFbnRlcidcbiAgICAgIGVudGVyZWRQZXJzb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgICAgZGVsZXRlUGVyc29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICAgIGRlbGV0ZVBlcnNvbi5pbm5lckhUTUwgPSAnLSdcbiAgICAgIGRlbGV0ZVBlcnNvbi5wYXJlbnQgPSBlbnRlcmVkUGVyc29uXG5cbiAgICAgIGRlbGV0ZVBlcnNvbi5vbmNsaWNrID0gLT5cbiAgICAgICAgcGVvcGxlLnJlbW92ZUNoaWxkIEBwYXJlbnRcbiAgICAgICAgcmV0dXJuXG5cbiAgICAgIGVudGVyZWRQZXJzb24uaW5uZXJIVE1MID0gbmV3R3Vlc3QudmFsdWVcbiAgICAgIGVudGVyZWRQZXJzb24udmFsdWUgPSBuZXdHdWVzdC52YWx1ZVxuICAgICAgIyBmb3IgZWFzeSBhY2Nlc3MgbGF0ZXJcbiAgICAgIGVudGVyZWRQZXJzb24uYXBwZW5kQ2hpbGQgZGVsZXRlUGVyc29uXG4gICAgICBwZW9wbGUuYXBwZW5kQ2hpbGQgZW50ZXJlZFBlcnNvblxuICAgICAgbmV3R3Vlc3QudmFsdWUgPSAnJ1xuICAgIHJldHVyblxuXG4gIG1vZGVsID0gbmV3IE1vZGVsXG4gICMgVXBkYXRlIHRoZSB2aWV3IG9uaW5wdXRcblxuICBtb2RlbC50aXRsZS5vbmlucHV0ID0gLT5cbiAgICB0aXRsZURpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGl0bGUtZGlzcGxheScpXG4gICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlciBtb2RlbC50aXRsZSwgdGl0bGVEaXNwbGF5LCAnVW50aXRsZWQgRXZlbnQnXG4gICAgcmV0dXJuXG5cbiAgbW9kZWwuZGVzY3JpcHRpb24ub25pbnB1dCA9IC0+XG4gICAgZGVzY3JpcHRpb25EaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtZGV0YWlsLWFjdHVhbC53aGF0JylcbiAgICBkaXNwbGF5V2l0aFBsYWNlaG9sZGVyIG1vZGVsLmRlc2NyaXB0aW9uLCBkZXNjcmlwdGlvbkRpc3BsYXksICdEZXNjcmlwdGlvbidcbiAgICByZXR1cm5cblxuICBtb2RlbC5sb2NhdGlvbi5vbmlucHV0ID0gLT5cbiAgICBsb2NhdGlvbkRpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZC1kZXRhaWwtYWN0dWFsLndoZXJlJylcbiAgICBkaXNwbGF5V2l0aFBsYWNlaG9sZGVyIG1vZGVsLmxvY2F0aW9uLCBsb2NhdGlvbkRpc3BsYXksICdQbGFjZSdcbiAgICByZXR1cm5cblxuICB3aGVuRGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLWRldGFpbC1hY3R1YWwud2hlbicpXG4gIGdldERvbU5vZGVBcnJheSgnLmlucHV0LWRhdGV0aW1lJykuZm9yRWFjaCAoZWxlbSkgLT5cblxuICAgIGVsZW0uYmluZGluZy5vbmlucHV0ID0gLT5cbiAgICAgICMgVE9ETzogYSBiaXQgaGFja3lcbiAgICAgIHRpbWVUb0Rpc3BsYXkgPSBtb2RlbC5kYXRlLnZhbHVlLnRvRGF0ZVN0cmluZygpICsgJyBmcm9tICcgKyBtb2RlbC5zdGFydFRpbWUudmFsdWUgKyAnIHRvICcgKyBtb2RlbC5lbmRUaW1lLnZhbHVlXG4gICAgICBkaXNwbGF5V2l0aFBsYWNlaG9sZGVyIHsgdmFsdWU6IHRpbWVUb0Rpc3BsYXkgfSwgd2hlbkRpc3BsYXksICdUaW1lJ1xuICAgICAgcmV0dXJuXG5cbiAgICByZXR1cm5cbiAgY3JlYXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uI2NyZWF0ZScpXG5cbiAgY3JlYXRlQnV0dG9uLm9uY2xpY2sgPSAtPlxuICAgIHZhbGlkU3RhdGUgPSB2YWxpZGF0ZSgpXG4gICAgaWYgIXZhbGlkU3RhdGUuaXNWYWxpZFxuICAgICAgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVycm9yLW1lc3NhZ2UnKVxuICAgICAgZXJyb3JNZXNzYWdlLmlubmVySFRNTCA9IHZhbGlkU3RhdGUuZXJyb3JNZXNzYWdlXG4gICAgZWxzZVxuICAgICAgYWxlcnQgJ1ZhbGlkIGZvcm0uIFRoYW5rcyBmb3Igc3VibWl0dGluZyEnXG4gICAgcmV0dXJuXG5cbiAgcmV0dXJuIiwiKGZ1bmN0aW9uKCkge1xuICB2YXIgQVBQO1xuXG4gIEFQUCA9IChmdW5jdGlvbigpIHtcblxuICAgIC8qXG4gICAgR2VuZXJhdGUgYWxsIHRoZSBvcHRpb25zIGZvciB0aGUgZGF0ZSBlbnRyaWVzXG4gICAgICovXG4gICAgdmFyIE1vZGVsLCBjcmVhdGVCdXR0b24sIGRheVNlbGVjdG9ycywgZGlzcGxheVdpdGhQbGFjZWhvbGRlciwgZ2V0RG9tTm9kZUFycmF5LCBtb2RlbCwgbW9udGhTZWxlY3RvcnMsIG5ld0d1ZXN0LCBwZW9wbGUsIHZhbGlkYXRlLCB3aGVuRGlzcGxheSwgeWVhclNlbGVjdG9ycztcbiAgICBkYXlTZWxlY3RvcnMgPSBnZXREb21Ob2RlQXJyYXkoJy5kYXknKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gQXJyYXkgb2YgRE9NIG5vZGVzIHRoYXQgbWF0Y2ggdGhlIHNlbGVjdG9yXG4gICAgICogQHBhcmFtIHNlbGVjdG9yIHtzdHJpbmd9IENTUyBzZWxlY3RvciAtIHNlbGVjdG9yIHRvIG1hdGNoIGFnYWluc3RcbiAgICAgKiBAcmV0dXJuIHthcnJheX0gQXJyYXkgb2YgRE9NIG5vZGVzXG4gICAgICovXG4gICAgZ2V0RG9tTm9kZUFycmF5ID0gZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICAgIHZhciBub2RlcztcbiAgICAgIG5vZGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbiAgICAgIGlmICghbm9kZXMpIHtcbiAgICAgICAgbm9kZXMgPSBbXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub2RlcztcbiAgICB9O1xuXG4gICAgLypcbiAgICBjbGFzcz1cIm1vZGVsIG1vZGVsLSpcIiBSZWZlciB0byBpbnB1dHMgYnkgdGhlIG5hbWUgYWZ0ZXIgY2xhc3MgbW9kZWwtKlxuICAgICAqL1xuICAgIE1vZGVsID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgQmluZGluZywgc2VsZjtcbiAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgQmluZGluZyA9IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XG4gICAgICAgIGVsZW0gPSBlbGVtIHx8IG51bGw7XG4gICAgICAgIHZhbHVlID0gdmFsdWUgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5lbGVtID0gZWxlbTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmhhc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vbmlucHV0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgIH07XG4gICAgICBnZXREb21Ob2RlQXJyYXkoJy5tb2RlbCcpLmZvckVhY2goZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgICAgICAgIHZhciBuYW1lLCBwb3NzaWJseU1hdGNoLCB2YWx1ZTtcbiAgICAgICAgICBwb3NzaWJseU1hdGNoID0gY2xhc3NOYW1lLm1hdGNoKC9tb2RlbFxcLS9nKTtcbiAgICAgICAgICBpZiAocG9zc2libHlNYXRjaCkge1xuICAgICAgICAgICAgbmFtZSA9IGNsYXNzTmFtZS5zbGljZSg2KTtcbiAgICAgICAgICAgIHZhbHVlID0gZWxlbS52YWx1ZTtcbiAgICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YoJ01vbnRoJykgPiAtMSkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIC0gMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZS5pbmRleE9mKCdUaW1lJyA+IC0xKSkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIHx8ICcwMDowMCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmW25hbWVdID0gc2VsZltuYW1lXSB8fCBuZXcgQmluZGluZyhlbGVtLCB2YWx1ZSk7XG4gICAgICAgICAgICBlbGVtLmJpbmRpbmcgPSBlbGVtLmJpbmRpbmcgfHwgc2VsZltuYW1lXTtcbiAgICAgICAgICAgIGVsZW0ub25pbnB1dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBzZWxmW25hbWVdLmhhc0NoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBzZWxmW25hbWVdID0gc2VsZltuYW1lXSB8fCBuZXcgQmluZGluZyhlbGVtLCB2YWx1ZSk7XG4gICAgICAgICAgICAgIHNlbGZbbmFtZV0udmFsdWUgPSBlbGVtLnZhbHVlO1xuICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUNhbGN1bGF0aW9ucygpO1xuICAgICAgICAgICAgICBzZWxmW25hbWVdLm9uaW5wdXQoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgc2VsZi51cGRhdGVDYWxjdWxhdGlvbnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZi5zdGFydE1pbiA9IHNlbGYuc3RhcnRNaW4gfHwgbmV3IEJpbmRpbmcobnVsbCwgc2VsZi5zdGFydFRpbWUudmFsdWUuc3BsaXQoJzonKVsxXSk7XG4gICAgICAgIHNlbGYuc3RhcnRIb3VyID0gc2VsZi5zdGFydEhvdXIgfHwgbmV3IEJpbmRpbmcobnVsbCwgc2VsZi5zdGFydFRpbWUudmFsdWUuc3BsaXQoJzonKVswXSk7XG4gICAgICAgIHNlbGYuZW5kTWluID0gc2VsZi5lbmRNaW4gfHwgbmV3IEJpbmRpbmcobnVsbCwgc2VsZi5lbmRUaW1lLnZhbHVlLnNwbGl0KCc6JylbMV0pO1xuICAgICAgICBzZWxmLmVuZEhvdXIgPSBzZWxmLmVuZEhvdXIgfHwgbmV3IEJpbmRpbmcobnVsbCwgc2VsZi5lbmRUaW1lLnZhbHVlLnNwbGl0KCc6JylbMF0pO1xuICAgICAgICBzZWxmLmRhdGUgPSBzZWxmLmRhdGUgfHwgbmV3IEJpbmRpbmc7XG4gICAgICAgIHNlbGYuZGF0ZS52YWx1ZSA9IG5ldyBEYXRlKHNlbGYuc3RhcnRZZWFyLnZhbHVlLCBzZWxmLnN0YXJ0TW9udGgudmFsdWUsIHNlbGYuc3RhcnREYXkudmFsdWUpO1xuICAgICAgfTtcbiAgICAgIHNlbGYudXBkYXRlQ2FsY3VsYXRpb25zKCk7XG4gICAgfTtcblxuICAgIC8qXG4gICAgVG8gY3JlYXRlIGEgcGxhY2Vob2xkZXIgZWZmZWN0LiBBc3N1bWVzIHRoYXQgZGlzcGxheSBlbGVtZW50IHN0YXJ0cyB3aXRoICdwbGFjZWhvbGRlcicgY2xhc3NcbiAgICAgKi9cbiAgICBkaXNwbGF5V2l0aFBsYWNlaG9sZGVyID0gZnVuY3Rpb24oaW5wdXRCaW5kaW5nLCBkaXNwbGF5RWxlbSwgcGxhY2Vob2xkZXIpIHtcbiAgICAgIGlmIChkaXNwbGF5RWxlbS5jbGFzc0xpc3QuY29udGFpbnMoJ3BsYWNlaG9sZGVyJykpIHtcbiAgICAgICAgZGlzcGxheUVsZW0uY2xhc3NMaXN0LnJlbW92ZSgncGxhY2Vob2xkZXInKTtcbiAgICAgIH1cbiAgICAgIGlmIChpbnB1dEJpbmRpbmcudmFsdWUgPT09ICcnKSB7XG4gICAgICAgIGlucHV0QmluZGluZy52YWx1ZSA9IHBsYWNlaG9sZGVyO1xuICAgICAgICBpbnB1dEJpbmRpbmcuaGFzQ2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBkaXNwbGF5RWxlbS5jbGFzc0xpc3QuYWRkKCdwbGFjZWhvbGRlcicpO1xuICAgICAgfVxuICAgICAgZGlzcGxheUVsZW0uaW5uZXJIVE1MID0gaW5wdXRCaW5kaW5nLnZhbHVlO1xuICAgIH07XG4gICAgdmFsaWRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhbGxHb29kLCBlcnJvck1lc3NhZ2UsIHBlb3BsZSwgc2VsZiwgdmFsaWRhdGlvbnM7XG4gICAgICBzZWxmID0gdGhpcztcbiAgICAgIGFsbEdvb2QgPSBmYWxzZTtcbiAgICAgIGVycm9yTWVzc2FnZSA9ICdQbGVhc2UgY29ycmVjdCB0aGUgZm9sbG93aW5nIGVycm9yczogPGJyPic7XG4gICAgICBwZW9wbGUgPSBnZXREb21Ob2RlQXJyYXkoJy5wZW9wbGU+ZGl2Jyk7XG4gICAgICB2YWxpZGF0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIGEgdGl0bGUuJyxcbiAgICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2RlbC50aXRsZS5oYXNDaGFuZ2VkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIGEgZGVzY3JpcHRpb24uJyxcbiAgICAgICAgICB2YWxpZGF0aW9uTWV0aG9kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2RlbC5kZXNjcmlwdGlvbi5oYXNDaGFuZ2VkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIGd1ZXN0cy4nLFxuICAgICAgICAgIHZhbGlkYXRpb25NZXRob2Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHBlb3BsZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgIGVycm9yTWVzc2FnZTogJ1BsZWFzZSBpbmNsdWRlIHZhbGlkIGVtYWlsIGFkZHJlc3Nlcy4nLFxuICAgICAgICAgIHZhbGlkYXRpb25NZXRob2Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGFyZVJlYWwsIGVtYWlsUmVnZXg7XG4gICAgICAgICAgICBhcmVSZWFsID0gZmFsc2U7XG4gICAgICAgICAgICBlbWFpbFJlZ2V4ID0gbmV3IFJlZ0V4cCgnXlstYS16MC05fiEkJV4mKl89K317XFwnP10rKC5bLWEtejAtOX4hJCVeJipfPSt9e1xcJz9dKykqQChbYS16MC05X11bLWEtejAtOV9dKiguWy1hLXowLTlfXSspKi4oYWVyb3xhcnBhfGJpenxjb218Y29vcHxlZHV8Z292fGluZm98aW50fG1pbHxtdXNldW18bmFtZXxuZXR8b3JnfHByb3x0cmF2ZWx8bW9iaXxbYS16XVthLXpdKXwoWzAtOV17MSwzfS5bMC05XXsxLDN9LlswLTldezEsM30uWzAtOV17MSwzfSkpKDpbMC05XXsxLDV9KT8kJyk7XG4gICAgICAgICAgICBwZW9wbGUuZm9yRWFjaChmdW5jdGlvbihndWVzdCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gZW1haWxSZWdleC5leGVjKGd1ZXN0LnZhbHVlKTtcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHRbJ2luZGV4J10gPT09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIGFyZVJlYWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBhcmVSZWFsID0gYXJlUmVhbCAmJiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcmVSZWFsID0gYXJlUmVhbCAmJiBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gYXJlUmVhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF07XG4gICAgICB2YWxpZGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCwgaW5kZXgpIHtcbiAgICAgICAgaWYgKHZhbC52YWxpZGF0aW9uTWV0aG9kKHNlbGYpKSB7XG4gICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICBhbGxHb29kID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWxsR29vZCA9IGFsbEdvb2QgJiYgdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWxsR29vZCA9IGFsbEdvb2QgJiYgZmFsc2U7XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlICsgdmFsLmVycm9yTWVzc2FnZSArICc8YnI+JztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UudHJpbSgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogYWxsR29vZCxcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvck1lc3NhZ2VcbiAgICAgIH07XG4gICAgfTtcbiAgICBkYXlTZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbihzZWxlY3RFbGVtZW50KSB7XG4gICAgICB2YXIgZGF5LCBuZXdPcHRpb247XG4gICAgICBkYXkgPSAxO1xuICAgICAgd2hpbGUgKGRheSA8IDMyKSB7XG4gICAgICAgIG5ld09wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICBpZiAoZGF5IDwgMTApIHtcbiAgICAgICAgICBkYXkgPSAnMCcgKyBkYXk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF5ID0gZGF5ICsgJyc7XG4gICAgICAgIH1cbiAgICAgICAgbmV3T3B0aW9uLmlubmVySFRNTCA9IGRheTtcbiAgICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmRDaGlsZChuZXdPcHRpb24pO1xuICAgICAgICBkYXkrKztcbiAgICAgIH1cbiAgICB9KTtcbiAgICBtb250aFNlbGVjdG9ycyA9IGdldERvbU5vZGVBcnJheSgnLm1vbnRoJyk7XG4gICAgbW9udGhTZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbihzZWxlY3RFbGVtZW50KSB7XG4gICAgICB2YXIgbW9udGgsIG5ld09wdGlvbjtcbiAgICAgIG1vbnRoID0gMTtcbiAgICAgIHdoaWxlIChtb250aCA8IDEzKSB7XG4gICAgICAgIG5ld09wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICBpZiAobW9udGggPCAxMCkge1xuICAgICAgICAgIG1vbnRoID0gJzAnICsgbW9udGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbW9udGggPSBtb250aCArICcnO1xuICAgICAgICB9XG4gICAgICAgIG5ld09wdGlvbi5pbm5lckhUTUwgPSBtb250aDtcbiAgICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmRDaGlsZChuZXdPcHRpb24pO1xuICAgICAgICBtb250aCsrO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHllYXJTZWxlY3RvcnMgPSBnZXREb21Ob2RlQXJyYXkoJy55ZWFyJyk7XG4gICAgeWVhclNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKHNlbGVjdEVsZW1lbnQpIHtcbiAgICAgIHZhciBuZXdPcHRpb24sIHllYXI7XG4gICAgICB5ZWFyID0gMjAxNTtcbiAgICAgIHdoaWxlICh5ZWFyIDwgMjAyMSkge1xuICAgICAgICBuZXdPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgbmV3T3B0aW9uLmlubmVySFRNTCA9IHllYXIgKyAnJztcbiAgICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmRDaGlsZChuZXdPcHRpb24pO1xuICAgICAgICB5ZWFyKys7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvKlxuICAgIEFkZGluZyBndWVzdHNcbiAgICAgKi9cbiAgICBuZXdHdWVzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Lm5ldy1ndWVzdCcpO1xuICAgIHBlb3BsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdHRlbmRlZXMnKTtcbiAgICBuZXdHdWVzdC5vbmtleWRvd24gPSBmdW5jdGlvbihldnQpIHtcbiAgICAgIHZhciBkZWxldGVQZXJzb24sIGVudGVyZWRQZXJzb247XG4gICAgICBpZiAoZXZ0LmtleUlkZW50aWZpZXIgPT09ICdFbnRlcicpIHtcbiAgICAgICAgZW50ZXJlZFBlcnNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBkZWxldGVQZXJzb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgZGVsZXRlUGVyc29uLmlubmVySFRNTCA9ICctJztcbiAgICAgICAgZGVsZXRlUGVyc29uLnBhcmVudCA9IGVudGVyZWRQZXJzb247XG4gICAgICAgIGRlbGV0ZVBlcnNvbi5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGVvcGxlLnJlbW92ZUNoaWxkKHRoaXMucGFyZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgZW50ZXJlZFBlcnNvbi5pbm5lckhUTUwgPSBuZXdHdWVzdC52YWx1ZTtcbiAgICAgICAgZW50ZXJlZFBlcnNvbi52YWx1ZSA9IG5ld0d1ZXN0LnZhbHVlO1xuICAgICAgICBlbnRlcmVkUGVyc29uLmFwcGVuZENoaWxkKGRlbGV0ZVBlcnNvbik7XG4gICAgICAgIHBlb3BsZS5hcHBlbmRDaGlsZChlbnRlcmVkUGVyc29uKTtcbiAgICAgICAgbmV3R3Vlc3QudmFsdWUgPSAnJztcbiAgICAgIH1cbiAgICB9O1xuICAgIG1vZGVsID0gbmV3IE1vZGVsO1xuICAgIG1vZGVsLnRpdGxlLm9uaW5wdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB0aXRsZURpc3BsYXk7XG4gICAgICB0aXRsZURpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGl0bGUtZGlzcGxheScpO1xuICAgICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlcihtb2RlbC50aXRsZSwgdGl0bGVEaXNwbGF5LCAnVW50aXRsZWQgRXZlbnQnKTtcbiAgICB9O1xuICAgIG1vZGVsLmRlc2NyaXB0aW9uLm9uaW5wdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBkZXNjcmlwdGlvbkRpc3BsYXk7XG4gICAgICBkZXNjcmlwdGlvbkRpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZC1kZXRhaWwtYWN0dWFsLndoYXQnKTtcbiAgICAgIGRpc3BsYXlXaXRoUGxhY2Vob2xkZXIobW9kZWwuZGVzY3JpcHRpb24sIGRlc2NyaXB0aW9uRGlzcGxheSwgJ0Rlc2NyaXB0aW9uJyk7XG4gICAgfTtcbiAgICBtb2RlbC5sb2NhdGlvbi5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbG9jYXRpb25EaXNwbGF5O1xuICAgICAgbG9jYXRpb25EaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtZGV0YWlsLWFjdHVhbC53aGVyZScpO1xuICAgICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlcihtb2RlbC5sb2NhdGlvbiwgbG9jYXRpb25EaXNwbGF5LCAnUGxhY2UnKTtcbiAgICB9O1xuICAgIHdoZW5EaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtZGV0YWlsLWFjdHVhbC53aGVuJyk7XG4gICAgZ2V0RG9tTm9kZUFycmF5KCcuaW5wdXQtZGF0ZXRpbWUnKS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIGVsZW0uYmluZGluZy5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0aW1lVG9EaXNwbGF5O1xuICAgICAgICB0aW1lVG9EaXNwbGF5ID0gbW9kZWwuZGF0ZS52YWx1ZS50b0RhdGVTdHJpbmcoKSArICcgZnJvbSAnICsgbW9kZWwuc3RhcnRUaW1lLnZhbHVlICsgJyB0byAnICsgbW9kZWwuZW5kVGltZS52YWx1ZTtcbiAgICAgICAgZGlzcGxheVdpdGhQbGFjZWhvbGRlcih7XG4gICAgICAgICAgdmFsdWU6IHRpbWVUb0Rpc3BsYXlcbiAgICAgICAgfSwgd2hlbkRpc3BsYXksICdUaW1lJyk7XG4gICAgICB9O1xuICAgIH0pO1xuICAgIGNyZWF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbiNjcmVhdGUnKTtcbiAgICBjcmVhdGVCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGVycm9yTWVzc2FnZSwgdmFsaWRTdGF0ZTtcbiAgICAgIHZhbGlkU3RhdGUgPSB2YWxpZGF0ZSgpO1xuICAgICAgaWYgKCF2YWxpZFN0YXRlLmlzVmFsaWQpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVycm9yLW1lc3NhZ2UnKTtcbiAgICAgICAgZXJyb3JNZXNzYWdlLmlubmVySFRNTCA9IHZhbGlkU3RhdGUuZXJyb3JNZXNzYWdlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWxlcnQoJ1ZhbGlkIGZvcm0uIFRoYW5rcyBmb3Igc3VibWl0dGluZyEnKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KSgpO1xuXG59KS5jYWxsKHRoaXMpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
